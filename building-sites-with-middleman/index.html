<!DOCTYPE html>
<html class='no-js'>
  <head>
    <meta charset='utf-8'>
    <meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
    <title>Building Sites with Middleman | Blank Page Tech</title>
    <meta name="site" content="Blank Page Tech" />
    <meta name="og:site_name" content="Blank Page Tech" />
    <meta name="title" content="Building Sites with Middleman" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Building Sites with Middleman" />
    <meta name="twitter:site" content="@wschenk" />
    <meta name="og:title" content="Building Sites with Middleman" />
    <meta content='width=device-width' name='viewport'>
    <link href="../stylesheets/application-274fcebf.css" rel="stylesheet" type="text/css" /><link href="../stylesheets/webicons-da5ecace.css" rel="stylesheet" type="text/css" /><link href="../stylesheets/socicons-d8ab83dd.css" rel="stylesheet" type="text/css" /><link href="../stylesheets/animate-8335fea6.css" rel="stylesheet" type="text/css" /><link href="../stylesheets/xcode-11a7835a.css" rel="stylesheet" type="text/css" />
    <link href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/styles/default.min.css' rel='stylesheet'>
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
  </head>
  <body data-spy='scroll' data-target='.sidebar'>
    <nav class="navbar navbar-default" role="navigation">
      <div class="container">
      <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapsable">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="/" class="navbar-brand">
      Blank Page Tech
    </a>
      
    </div>
    <div class="collapse navbar-collapse" id="navbar-collapsable">
      <ul class="nav navbar-nav navbar-right foo" id="menu">
      <li>
      <a href="/articles/">
        Articles
      </a>
    </li>
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown">Topics <b class="caret"></b></a>
      <ul class="dropdown-menu">
        <li>
      <a href="/tags/howto/">
        Howtos
      </a>
    </li>
    <li>
      <a href="/tags/overview/">
        Overviews
      </a>
    </li>
    <li>
      <a href="/tags/tools/">
        Tools
      </a>
    </li>
    <li>
      <a href="/tags/socialinvestigator/">
        Social Investigator
      </a>
    </li>
    <li>
      <a href="/tags/ruby/">
        Ruby & Rails
      </a>
    </li>
    
      </ul>
    </li>
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tags <b class="caret"></b></a>
      <ul class="dropdown-menu">
        <li>
      <a href="/tags/bootstrap/">
        bootstrap
      </a>
    </li>
    <li>
      <a href="/tags/bots/">
        bots
      </a>
    </li>
    <li>
      <a href="/tags/happy_seed/">
        happy_seed
      </a>
    </li>
    <li>
      <a href="/tags/howto/">
        howto
      </a>
    </li>
    <li>
      <a href="/tags/middleman/">
        middleman
      </a>
    </li>
    <li>
      <a href="/tags/osx/">
        osx
      </a>
    </li>
    <li>
      <a href="/tags/overview/">
        overview
      </a>
    </li>
    <li>
      <a href="/tags/product/">
        product
      </a>
    </li>
    <li>
      <a href="/tags/rails/">
        rails
      </a>
    </li>
    <li>
      <a href="/tags/redis/">
        redis
      </a>
    </li>
    <li>
      <a href="/tags/ruby/">
        ruby
      </a>
    </li>
    <li>
      <a href="/tags/socialinvestigator/">
        socialinvestigator
      </a>
    </li>
    <li>
      <a href="/tags/sql/">
        sql
      </a>
    </li>
    <li>
      <a href="/tags/startupmyths/">
        startupmyths
      </a>
    </li>
    <li>
      <a href="/tags/thor/">
        thor
      </a>
    </li>
    <li>
      <a href="/tags/tools/">
        tools
      </a>
    </li>
    <li>
      <a href="/tags/toys/">
        toys
      </a>
    </li>
    
      </ul>
    </li>
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown">Archives <b class="caret"></b></a>
      <ul class="dropdown-menu">
        <li>
      <a href="/2014/12/">
        Dec 2014
      </a>
    </li>
    <li>
      <a href="/2014/11/">
        Nov 2014
      </a>
    </li>
    <li>
      <a href="/2014/10/">
        Oct 2014
      </a>
    </li>
    
      </ul>
    </li>
    
    </ul>
    
    </div>
    
    </div>
    </nav>
    <div class='banner'>
      <img class="fadeInDown animated" src="../images/books-f3c1e5c5.jpg" />
    </div>
    <div class='article-header lighter '>
      <h1>Building Sites with Middleman</h1>
      <h2>lean publishing</h2>
      <div class='tags'>
        <div class='tag'><a class="btn btn-primary" href="/tags/howto/">howto</a></div>
        <div class='tag'><a class="btn btn-primary" href="/tags/middleman/">middleman</a></div>
        <div class='tag'><a class="btn btn-primary" href="/tags/ruby/">ruby</a></div>
        <div class='tag'><a class="btn btn-primary" href="/tags/tools/">tools</a></div>
      </div>
      <a href='#comment_shower' id='comment_shower_scroll'>
        <span class='disqus-comment-count' data-disqus-identifier='2014-11-25-building-sites-with-middleman.html'></span>
      </a>
    </div>
    <div class='content'>
      <div class='row'>
        <div class='sidebar'>
          <ul class='nav toc' data-offset-top='400' data-spy='affix'>
            <li><a href="#top">Building Sites with Middleman</a></li>
            <li><a href="#setting-up-a-simple-static-site-with-middleman">Setting up a simple static site with Middleman</a></li>
            <li><a href="#gemfile">Gemfile</a></li>
            <li><a href="#tweaking-middleman">Tweaking Middleman</a></li>
            <li><a href="#using-bower">Using bower</a></li>
            <li><a href="#using-layouts-and-partials">Using layouts and partials</a></li>
            <li><a href="#the-yaml-preable-the-preyaml">The YAML preable the preyaml</a></li>
            <li><a href="#how-the-build-works">How the build works</a></li>
            <li><a href="#middleman-server">middleman server</a></li>
            <li><a href="#middleman-build">middleman build</a></li>
            <li><a href="#middleman-deploy">middleman deploy</a></li>
            <li><a href="#building-a-blog">Building a blog</a></li>
            <li><a href="#what-does-it-add">What does it add</a></li>
            <li><a href="#go-get-started">Go get started</a></li>
          </ul>
        </div>
        <div class='article' id='top'>
          <p>I make a lot of websites, and I have a certain toolkit that I use to build them.  The most useful things I use are:</p>
          
          <ul>
          <li>layouts and partials so I only need to set things up once</li>
          <li><code>haml</code> for writing html, since I don&#39;t like closing tags</li>
          <li><code>Bootstrap</code> and <code>sass</code> for writing css</li>
          <li><code>Markdown</code> for formatting large blogs of content</li>
          <li><code>coffeescript</code> for JavaScript</li>
          </ul>
          
          <p>Middleman is a static site generator, which means that it takes a bunch of source files, does some stuff with it, and produces static HTML, CSS, Images, and Javascript that can be hosted on a basic server somewhere, including <a href="http://docs.aws.amazon.com/AmazonS3/latest/dev/WebsiteHosting.html">hosting on S3</a> or <a href="https://pages.github.com">Github Pages</a> so you don&#39;t need to consider a server.</p>
          
          <p>Middleman is written in Ruby, so it&#39;s our familiar toolset, and unlike <a href="http://jekyllrb.com">Jekyll</a> it uses <a href="https://github.com/sstephenson/sprockets">Sprockets</a>, which is the same asset pipelining system that Rails uses.  So you get all the benefits of using a robust system that works for Rails apps without having to learn a bunch more things.</p>
          
          <p>In the node world <a href="http://yeoman.io">Yeoman</a> does something similar, but I personally have had poor luck getting <a href="http://gruntjs.com">Grunt</a> to work reliably in practice.</p>
          
          <h2 id="setting-up-a-simple-static-site-with-middleman">Setting up a simple static site with Middleman</h2>
          
          <p>One of the problems with starting with Middleman is that there are so many places to start.  Lets look at how to setup a basic middleman site with bootstrap-sass, haml, and bower.  First thing is to install middleman:</p>
          
          <pre><code class="sh">$ gem install middleman&#x000A;</code></pre>
          
          <p>And create an app:</p>
          
          <pre><code class="sh">$ middleman new static_site&#x000A;[...]&#x000A;      create  static_site/.gitignore&#x000A;      create  static_site/config.rb&#x000A;      create  static_site/source/index.html.erb&#x000A;      create  static_site/source/layouts/layout.erb&#x000A;      create  static_site/source/stylesheets&#x000A;      create  static_site/source/stylesheets/all.css&#x000A;      create  static_site/source/stylesheets/normalize.css&#x000A;      create  static_site/source/javascripts&#x000A;      create  static_site/source/javascripts/all.js&#x000A;      create  static_site/source/images&#x000A;      create  static_site/source/images/background.png&#x000A;      create  static_site/source/images/middleman.png&#x000A;</code></pre>
          
          <p>This creates 4 files in the main directory, <code>Gemfile</code> and <code>Gemfile.lock</code>, which we know and love, <code>config.rb</code> which configures how middleman generates the site, and <code>source</code> which are the sourcefiles of the site.</p>
          
          <h2 id="gemfile">Gemfile</h2>
          
          <p>By default, <code>middleman</code> installs the <code>middleman-livereload</code> plugin, so in development mode any browers that have a page open with refresh when you save a file.  This makes testing a lot easier.  We can install other gems here to add different functionality.  Let&#39;s add a few of these now:</p>
          
          <pre><code class="rb">gem &quot;middleman-deploy&quot;&#x000A;gem &#39;middleman-bootstrap-navbar&#39;&#x000A;gem &quot;bootstrap-sass&quot;&#x000A;gem &quot;jquery-middleman&quot;&#x000A;</code></pre>
          
          <p>The first two gems expand the functionality of middleman, one to add tasks to push the final site build to <code>s3</code>, <code>gh-pages</code> and a whole bunch more, and the second to make it easier to build <code>bootstrap</code> navbars.</p>
          
          <p>The file two are including <code>bootstrap-sass</code> -- the same that we use for rails sites -- and <code>jquery</code>.  These get included into the sprockets asset path, so you don&#39;t need to maintain them in your project.  (We&#39;ll also see below how to integrate <code>bower</code> components into your project.)</p>
          
          <h2 id="tweaking-middleman">Tweaking Middleman</h2>
          
          <p><code>config.rb</code> is where we configure how middleman itself works.</p>
          
          <pre><code class="rb"># For custom domains on github pages&#x000A;page &quot;CNAME&quot;, layout: false&#x000A;&#x000A;set :css_dir, &#39;stylesheets&#39;&#x000A;set :js_dir, &#39;javascripts&#39;&#x000A;set :images_dir, &#39;images&#39;&#x000A;&#x000A;# Better markdown support&#x000A;# set :markdown, :tables =&gt; true, :autolink =&gt; true, :gh_blockcode =&gt; true, :fenced_code_blocks =&gt; true&#x000A;# set :markdown_engine, :redcarpet&#x000A;&#x000A;# Turn this on if you want to make your url&#39;s prettier, without the .html&#x000A;activate :directory_indexes&#x000A;&#x000A;# Automatic image dimensions on image_tag helper&#x000A;# activate :automatic_image_sizes&#x000A;&#x000A;# Easier bootstrap navbars&#x000A;activate :bootstrap_navbar&#x000A;&#x000A;configure :development do&#x000A;  activate :livereload&#x000A;end&#x000A;&#x000A;# Build-specific configuration&#x000A;configure :build do&#x000A;  # Any files you want to ignore:&#x000A;  ignore &#39;/admin/*&#39;&#x000A;&#x000A;  # For example, change the Compass output style for deployment&#x000A;  activate :minify_css&#x000A;&#x000A;  # Minify Javascript on build&#x000A;  activate :minify_javascript&#x000A;&#x000A;  # Enable cache buster&#x000A;  activate :asset_hash&#x000A;&#x000A;  # Use relative URLs&#x000A;  activate :relative_assets&#x000A;end&#x000A;&#x000A;&#x000A;# This will push to the gh-pages branch of the repo, which will&#x000A;# host it on github pages (If this is a github repository)&#x000A;activate :deploy do |deploy|&#x000A;  deploy.method = :git&#x000A;  deploy.build_before = true&#x000A;end&#x000A;</code></pre>
          
          <p>Lets go through this in detail.</p>
          
          <p><code>page &quot;CNAME&quot;, layout: false</code>  says to move the file called <code>CNAME</code> over without wrapping in the main layout.  Since this file doesn&#39;t have .html in the name, it would otherwise get ignored.  This file is for having a custom domain on Github Pages, if that&#39;s the sort of thing you are in to.</p>
          
          <p>The <code>set</code> commands are there to configure different middleman settings, here to show where the various stylesheet, image, and css directories are.</p>
          
          <p><code>activate :directory_indexes</code> with enable <em>pretty urls</em>.  Directory indexes means that files named <code>about.html</code> will actually get generated into a file called <code>/about/index.html</code>, and will rely on the underlying server to have <code>/about</code> actually show the directory &quot;index&quot; page, making the urls prettier.  This doesn&#39;t work on all servers but works on most of them.  This plugin will actually rewrite the output of the <code>link_to</code> tags, so you don&#39;t need to adjust your templates to work.</p>
          
          <p><code>activate :bootstrap_navbar</code> is an extension that we added in the Gemfile, which makes it easier to generate bootstrap navbars.  Extensions generally work in three ways: they add helper methods, they change the way that the sitemap is processed, or they add different commands to the &quot;middleman&quot; command.</p>
          
          <p>We see an example of that at the bottom of the <code>config.rb</code> file, where we configure the <code>deploy</code> extension:</p>
          
          <pre><code class="rb">activate :deploy do |deploy|&#x000A;  deploy.method = :git&#x000A;  deploy.build_before = true&#x000A;end&#x000A;</code></pre>
          
          <p>This also takes some configuration, and in this case it set to deploy to github pages, and to make sure that it generates the site before doing so.  Here is the <a href="https://github.com/karlfreeman/middleman-deploy">middleman-deploy</a> github page with documentation.</p>
          
          <p>There are two sections that each configure a different middleman environment.  The first is used when you run <code>middleman server</code> to look at the site locally:</p>
          
          <pre><code class="rb">configure :development do&#x000A;  activate :livereload&#x000A;end&#x000A;</code></pre>
          
          <p>The final section is configuring the <code>build</code> process, when you run <code>middleman build</code> and it creates the generated files in the <code>build</code> directory.  The entry below ignores certain files for the build, and runs minifiers over the css and javascript, and turns on <em>cache busting</em>.</p>
          
          <pre><code class="rb"># Build-specific configuration&#x000A;configure :build do&#x000A;  # Any files you want to ignore:&#x000A;  ignore &#39;/admin/*&#39;&#x000A;&#x000A;  # For example, change the Compass output style for deployment&#x000A;  activate :minify_css&#x000A;&#x000A;  # Minify Javascript on build&#x000A;  activate :minify_javascript&#x000A;&#x000A;  # Enable cache buster&#x000A;  activate :asset_hash&#x000A;&#x000A;  # Use relative URLs&#x000A;  activate :relative_assets&#x000A;end&#x000A;</code></pre>
          
          <h2 id="using-bower">Using bower</h2>
          
          <p>The basic way to use bower is to put this in <code>config.rb</code>:</p>
          
          <pre><code class="rb">sprockets.append_path File.join root, &#39;bower_components&#39;&#x000A;</code></pre>
          
          <p>And then you can put things in your <code>all.js</code> file like</p>
          
          <pre><code class="javascript">//= require &#39;component&#39;&#x000A;</code></pre>
          
          <p>To get all of the assets that are included in the packge, you may need to specify the package in the <code>config.rb</code> file, such as:</p>
          
          <pre><code class="rb">sprockets.import_asset &#39;jquery&#39;&#x000A;</code></pre>
          
          <p>More information on the <a href="http://middlemanapp.com/basics/asset-pipeline/">Middleman Asset Pipline documentation</a></p>
          
          <h2 id="using-layouts-and-partials">Using layouts and partials</h2>
          
          <p>The <code>source</code> directory is where the actual code for your site lives.  Here is an example <code>layouts/layout.haml</code> file to give you a sense of how to use layouts and include partials:</p>
          
          <pre><code class="haml">!!! 5&#x000A;%html.no-js.sticky&#x000A;  %head&#x000A;    %meta{ :charset =&gt; &#39;utf-8&#39; }/&#x000A;    %meta{ &#39;http-equiv&#39; =&gt; &#39;X-UA-Compatible&#39;, :content =&gt; &#39;IE=edge,chrome=1&#39; }/&#x000A;&#x000A;    %title This site is amazing!&#x000A;&#x000A;    %meta{ :name =&gt; &#39;description&#39;, :content =&gt; &#39;&#39; }/&#x000A;    %meta{ :name =&gt; &#39;viewport&#39;, :content =&gt; &#39;width=device-width&#39; }/&#x000A;    = stylesheet_link_tag &#39;application&#39;, &quot;socicons&quot;, &quot;animate&quot;&#x000A;&#x000A;  %body&#x000A;    = partial &quot;layouts/main_header&quot;&#x000A;&#x000A;    ~ yield&#x000A;&#x000A;    = partial &quot;layouts/footer&quot;&#x000A;    = partial &quot;layouts/javascripts&quot;&#x000A;</code></pre>
          
          <p>In this usage, this is similar to the way that rails layouts work.  I&#39;m using the <code>~</code> HAML operator inside of <code>=</code> here because I want to make sure that it doesn&#39;t do anything wonky with the indention on <code>&lt;pre&gt;</code> blocks, btw.</p>
          
          <p>Middleman has a concept of nested layouts, which lets you have wrap an a layout around another one.  I think that this is confusing in practice, but as an example you could have a <code>layouts/sidebar_layout.erb</code> that looked like:</p>
          
          <pre><code class="erb">&lt;% wrap_layout :layout do %&gt;&#x000A;    &lt;div class=&quot;sidebar&quot;&gt;&#x000A;        &lt;%= partial &quot;layouts/sidebar&quot; %&gt;&#x000A;    &lt;/div&gt;&#x000A;&#x000A;    &lt;div class=&quot;content&quot;&gt;&#x000A;        &lt;%= yield %&gt;&#x000A;    &lt;/div&gt;&#x000A;&lt;% end %&gt;&#x000A;</code></pre>
          
          <h2 id="the-yaml-preable-the-preyaml">The YAML preable the preyaml</h2>
          
          <p>Metadata about the template is included in a block of text at the top of the file, which gets pulled off to set things that the templating system can use later.  On the top of this file that I am editing right now, it looks like this</p>
          
          <pre><code>---&#x000A;title: &#39;Building Sites with Middleman&#39;&#x000A;subtitle: &#39;lean publishing&#39;&#x000A;tags: middleman, ruby, howto&#x000A;header_image: books.jpg&#x000A;---&#x000A;&#x000A;I make a lot of websites, and I have a certain toolkit that I use to build... &#x000A;</code></pre>
          
          <p>The <code>title</code>, <code>subtitle</code>, <code>tags</code> and <code>header_image</code> attributues are available in the templates as page data, so you can access them like:</p>
          
          <pre><code class="haml">  %h1= current_article.title&#x000A;  %h2= current_article.data[&#39;subtitle&#39;]&#x000A;</code></pre>
          
          <p><em>title</em> is built into middleman, <em>subtitle</em> and <em>header image</em> are just some random things I made up.  The <code>tags</code> attribute is part of the <code>middleman-blog</code> extension which we will cover below.</p>
          
          <h2 id="how-the-build-works">How the build works</h2>
          
          <p>When you run <code>middleman server</code> or <code>middleman build</code>, middleman loads up the configuration file in <code>config.rb</code>.  It creates a sitemap based upon the files in the <code>source</code> directory as well as other directives inside of the config.rb file. </p>
          
          <p>By default it only includes files like <code>.html.erb</code> and <code>.js</code>, but you can set it manually include a non-template file (like our <code>page &quot;CNAME&quot;</code> above or create other <code>proxy</code> files.  Proxy files are a way of seperating out the templates from the source data.</p>
          
          <pre><code class="rb"># Assumes the file source/about/template.html.erb exists&#x000A;[&quot;tom&quot;, &quot;dick&quot;, &quot;harry&quot;].each do |name|&#x000A;  proxy &quot;/about/#{name}.html&quot;, &quot;/about/template.html&quot;, :locals =&gt; { :person_name =&gt; name }&#x000A;end&#x000A;</code></pre>
          
          <p>This creates three entries into the sitemap called <code>/about/tom.html</code>, <code>/about/dick.html</code> and <code>/about/harry.html</code> that use a specific template.</p>
          
          <p>This data doesn&#39;t need to be hardcoded into the <code>config.rb</code> btw, you can also place <code>json</code> and <code>yml</code> files in the <code>data/</code> directory which middleman will load automatically.  For example, <code>data/employees.json</code></p>
          
          <pre><code class="json">[{&quot;name&quot;:&quot;Tom&quot;,&quot;title&quot;:&quot;Janitor&quot;},{&quot;name&quot;:&quot;Mary&quot;,&quot;title&quot;:&quot;CEO&quot;}]&#x000A;</code></pre>
          
          <p>And then in your <code>config.rb</code> you could access this as:</p>
          
          <pre><code class="rb">data[&#39;employees&#39;].each do |employee|&#x000A;  proxy &quot;/about/#{name}.html&quot;, &quot;/about/template.html&quot;, :locals =&gt; { :person_name =&gt; employee[:name], :title =&gt; employee[:title] }&#x000A;end&#x000A;</code></pre>
          
          <p>Then each entry in the sitemap the file is processed (based upon the extension, so scss -&gt; js, haml -&gt; html, etc.) into the build directory.  Helper methods are available inside of the templates for things like <code>javascript_include_tag</code>, <code>stylesheet_link_tag</code>, <code>link_to</code> and <code>image_tag</code> and all of the rest.</p>
          
          <h2 id="middleman-server">middleman server</h2>
          
          <p>Starting the server in preview mode will start a local server on port <code>4567</code> that generates the files on demand.  If you have livereload enabled this will automatically trigger a page refresh for any open browsers, so you can tweak and look at things as you go.</p>
          
          <p>Inside of your templates, <code>config.environment == :development</code> when you are in preview mode.  So, if there are some things that you don&#39;t want to push to the live site but are useful for development, you can switch them on and off using that mechanism.</p>
          
          <h2 id="middleman-build">middleman build</h2>
          
          <p>This does basically the same thing as the server, but the templates are generally further processed.  Cachebusting can be enabled, and you can include tracking code if <code>config.environment == :build</code> is true.  This goes through all of the files in source that look like webfiles and places them in the <code>build</code> directory.</p>
          
          <p>And easy way to check out what you have there is by <code>cd</code>ing into the <code>build/</code> directory and running a simple webserver to serve the pages.  Relative links don&#39;t work when you open the file directly in the browser, so you need to use an actual webserver.</p>
          
          <pre><code class="sh">$ cd build&#x000A;$ python -m SimpleHTTPServer&#x000A;</code></pre>
          
          <p>And then open a new browser on port <code>8000</code>.</p>
          
          <h2 id="middleman-deploy">middleman deploy</h2>
          
          <p>In the basic <code>:git</code> setting that we have above, middleman deploy will build the site into the <code>build/</code> directory, switch that directory to the <code>gh-pages</code> branch, and push it to <code>origin</code>.  Assuming that you are hosting your repo on github, this will publish the static content on github pages.</p>
          
          <p>If you want to use a <a href="https://help.github.com/articles/setting-up-a-custom-domain-with-github-pages/">custom domain</a> then you need to create a <code>CNAME</code> file in <code>source/</code> with the domain name, and set up your DNS records to match.</p>
          
          <p>One thing to note is that while changes to the pages seem to deploy quickly, it takes a long time for the first push to github pages to show up, on the order of 10-15 minutes.</p>
          
          <p>More information on <a href="https://github.com/karlfreeman/middleman-deploy">middleman-deploy</a>.</p>
          
          <h2 id="building-a-blog">Building a blog</h2>
          
          <p>There are two good extensions for building a blog with middleman.  The default template for blog is sort of confusing in the way that it&#39;s laid out, mainly because it gets rid of the <code>layouts/</code> directory, but let&#39;s go through it and see how it&#39;s supposed to work:</p>
          
          <pre><code class="sh">$ gem install middleman-blog&#x000A;$ middleman new static_blog --template=blog&#x000A;      create  static_blog/.gitignore&#x000A;      create  static_blog/config.rb&#x000A;      create  static_blog/source&#x000A;      create  static_blog/source/2012-01-01-example-article.html.markdown&#x000A;      create  static_blog/source/calendar.html.erb&#x000A;      create  static_blog/source/feed.xml.builder&#x000A;      create  static_blog/source/index.html.erb&#x000A;      create  static_blog/source/layout.erb&#x000A;      create  static_blog/source/tag.html.erb&#x000A;      create  static_blog/source/stylesheets&#x000A;      create  static_blog/source/javascripts&#x000A;      create  static_blog/source/images&#x000A;</code></pre>
          
          <p>Now we have another middleman site, with a bunch of files.  It also creates a new command:</p>
          
          <pre><code class="sh">$ middleman article &quot;This is the title of my article&quot;&#x000A;</code></pre>
          
          <p>Let&#39;s also include the <code>middleman-blog-drafts</code> gem into the <code>Gemfile</code>, <code>activate :drafts</code> in `config.rb, and that will give us a few more commands:</p>
          
          <pre><code class="sh">$ middleman draft &quot;This is amazing&quot;&#x000A;      create  source/drafts/this-is-amazing.html.markdown&#x000A;$ middleman publish source/drafts/this-is-amazing.html.markdown&#x000A;      create  source/2014-11-25-this-is-amazing.html.markdown&#x000A;      remove  source/drafts/this-is-amazing.html.markdown&#x000A;</code></pre>
          
          <p>This lets us keep drafts in git and doesn&#39;t force us to commit to a date until we are ready to publish it.  There are <code>published</code> and <code>date</code> attributes that the default blog extension knows about to turn it on and off, and is a good example of something that you can see in development but not production, but that still leaves to moving files around manually to adjust the date.</p>
          
          <h2 id="what-does-it-add">What does it add</h2>
          
          <p>In addition to the sitemap, we now have a <code>blog</code>, <code>article</code>, and <code>tag</code> concept inside of the middleman app.  Articles are represented as pages (by default using <code>markdown</code>) but the <code>tag</code> and <code>calendar</code> templates are actually more like <code>proxy</code> templates than file templates, and when the site is generated middleman will iterate over then to produce many output files from one template.</p>
          
          <p>Part of the <code>index.html.haml</code> of this site looks like:</p>
          
          <pre><code class="haml">  - (drafts + page_articles).each do |article|&#x000A;    .post&#x000A;      .post-date&#x000A;        - unless article.is_a? ::Middleman::Blog::Drafts::DraftArticle&#x000A;          %p= article.date.strftime( &#39;%b %e&#39; )&#x000A;        - else&#x000A;          %p.draft Draft&#x000A;</code></pre>
          
          <p>I&#39;m putting all of the articles in a list, both drafts and published ones, and only showing the date for articles which have already been published.</p>
          
          <p>Here&#39;s what gets added to the <code>config.rb</code>:</p>
          
          <pre><code class="rb">activate :blog do |blog|&#x000A;  # This will add a prefix to all links, template references and source paths&#x000A;  # blog.prefix = &quot;blog&quot;&#x000A;&#x000A;  # blog.permalink = &quot;{year}/{month}/{day}/{title}.html&quot;&#x000A;  # Matcher for blog source files&#x000A;  # blog.sources = &quot;{year}-{month}-{day}-{title}.html&quot;&#x000A;  # blog.taglink = &quot;tags/{tag}.html&quot;&#x000A;  # blog.layout = &quot;layout&quot;&#x000A;  # blog.summary_separator = /()/&#x000A;  # blog.summary_length = 250&#x000A;  # blog.year_link = &quot;{year}.html&quot;&#x000A;  # blog.month_link = &quot;{year}/{month}.html&quot;&#x000A;  # blog.day_link = &quot;{year}/{month}/{day}.html&quot;&#x000A;  # blog.default_extension = &quot;.markdown&quot;&#x000A;&#x000A;  blog.tag_template = &quot;tag.html&quot;&#x000A;  blog.calendar_template = &quot;calendar.html&quot;&#x000A;&#x000A;  # Enable pagination&#x000A;  # blog.paginate = true&#x000A;  # blog.per_page = 10&#x000A;  # blog.page_link = &quot;page/{num}&quot;&#x000A;end&#x000A;&#x000A;activate :drafts&#x000A;</code></pre>
          
          <p>This should be enough to get you started, and more <a href="http://middlemanapp.com/basics/blogging/">documentation is here</a> .  At this point it really becomes a design and development challenge, not figuring out how to use the tool.</p>
          
          <h2 id="go-get-started">Go get started</h2>
          
          <p>Middleman gives you all of the front-end developer benefits of using a system like Rails, but outputs static content than can be served anywhere without any dependancies.  Many sites don&#39;t really require all that for them to run, and it&#39;s crazy to me that something as read heavy as a blog often can&#39;t perform well under load given that it&#39;s just serving up the same old stuff over and over again.  You want to have some tooling to make it easier, but it doesn&#39;t need to be <em>run time</em> tooling.</p>
          
          <p><em>Image Credit: <a href="https://www.flickr.com/photos/aigle_dore/6365101775/in/photolist-aGsP14-7PozJp-84P71r-dphot9-5qz3ks-eqHuv-6NP8d6-HdurS-aibaen-ix8Rbz-6buevW-7acJMF-8DFBf3-MLnGM-dGa2xi-f4HeM7-zXqL6-88og6h-r7w3U-2qKgwi-mcp7h-4eXcGM-9uv3gC-7BAEiV-5RzRtp-7JKRHh-6iUdMZ-2bUDT-8s4PDi-8pvSWc-dynb6k-zV2x5-4xWMzG-dsxGqc-7Cby3b-9t3zWm-b4jsc2-8YyqSQ-9ggca5-aGsPSg-68SVDi-4PNHrt-7JGpz4-aL22G2-q1ic-sZMVW-84NAEC-8JBSSW-9k6cM-89NBaJ">Moyan Brenn</a></em></p>
        </div>
        <div class='navigation' data-offset-top='400' data-spy='affix'>
          <div class='next'>
            <p>
              Next in
              <a href="/tag/Chronological.html">Chronological</a>
              <a href="/tag/Ruby.html">Ruby</a>
              <a href="/tag/Tools.html">Tools</a>
            </p>
            <p class='title'><a href="/new-happyseed-released/">New HappySeed released</a></p>
            <p>
              Next in
              <a href="/tag/Middleman.html">Middleman</a>
            </p>
            <p class='title'><a href="/middleman-tricks-and-hacks/">Middleman Tricks and Hacks</a></p>
            <p>
              Next in
              <a href="/tag/Howto.html">Howto</a>
            </p>
            <p class='title'><a href="/pulling-data-out-of-google-analytics/">Pulling data out of Google Analytics</a></p>
          </div>
          <div class='prev'>
            <p>
              Previously in
              <a href="/tag/Chronological.html">Chronological</a>
              <a href="/tag/Ruby.html">Ruby</a>
              <a href="/tag/Howto.html">Howto</a>
            </p>
            <p class='title'><a href="/scripting-twitter/">Scripting Twitter: Collecting Data and Writing Bots</a></p>
            <p>
              Previously in
              <a href="/tag/Tools.html">Tools</a>
            </p>
            <p class='title'><a href="/bootstrap-advanced-grid-tricks/">Bootstrap: Advanced Grid Tricks</a></p>
          </div>
        </div>
      </div>
      <div class="row article_footer">
        <div class="comments">
            <a href="#" id="comment_shower">
              <span class="socicon socicon-disqus fgcolor"></span>
              <span class="disqus-comment-count" data-disqus-identifier="2014-11-25-building-sites-with-middleman.html">Be the first to comment.</span>
            </a>
        </div>
        <div class="sharing">
          <a href="http://www.twitter.com/share?url=http://willschenk.com//building-sites-with-middleman/&amp;text=Building Sites with Middleman by @wschenk" title="Share this post on Twitter" data-lang="en" onclick="return !window.open(this.href, 'Twitter', 'width=640,height=300')"><span class="socicon socicon-twitter fgcolor"></span></a>
      
          <a target="_blank" onclick="return !window.open(this.href, 'Facebook', 'width=640,height=300')" href="http://www.facebook.com/sharer/sharer.php?u=http://willschenk.com//building-sites-with-middleman/" title="Share this post on Facebook"><span class="socicon socicon-facebook fgcolor"></span></a>
      
          <a href="http://plus.google.com/share?url=http://willschenk.com//building-sites-with-middleman/" target="_blank" onclick="return !window.open(this.href, 'Google +', 'width=640,height=300')" title="Share this post on Google +"><span class="socicon socicon-google fgcolor"></span></a>
        </div>
      </div>
        <div class="row comment_universe">
          <div id="disqus_thread" class="col-sm-10 col-sm-offset-1"></div>
        </div>
    </div>
    <footer class='academy'>
      <div class='container'>
        <div class='row'>
          <div class='logo'>
            <a href='http://hfcacademy.com'>
              <img class="img-responsive" src="../images/academy-logo-f112afa1.png" />
            </a>
          </div>
          <div class='body'>
            <h1>Come join us in person!</h1>
            <p>HFC Technology Academy is dedicated to teaching people the skills they need to succeed in the world of technology and startups.</p>
            <p>The Academy is for anyone with the passion to learn about entrepreneurship, development, product management and other skills within the start-up community.</p>
            <h2><a href="http://www.hfcacademy.com/events">Read about our free events</a></h2>
          </div>
        </div>
      </div>
    </footer>
    <footer class='footer lighter '>
      <div class='container'>
        <div class='row'>
          <div class='social'>
            <span>
              <a class='webicon twitter' href='http://twitter.com/wschenk'></a>
            </span>
            <span>
              <a class='webicon tumblr' href='http://sublimeguile.com/'></a>
            </span>
            <span>
              <a class='webicon instagram' href='http://instagram.com/wschenk'></a>
            </span>
            <span>
              <a class='webicon linkedin' href='http://www.linkedin.com/pub/will-schenk/0/266/420/'></a>
            </span>
            <span>
              <a class='webicon github' href='https://github.com/wschenk'></a>
            </span>
            <span>
              <a class='webicon rss' href='http://willschenk.com/feed.xml'></a>
            </span>
            <span>
              <a class='webicon mail' href='mailto:will@happyfuncorp.com'></a>
            </span>
          </div>
          <div class='made_in_bk'>
            <h3>Made in Brooklyn, NY</h3>
          </div>
        </div>
      </div>
    </footer>
    <script src="../javascripts/application-05d0bd9b.js" type="text/javascript"></script><script src="../javascripts/modernizr-84a49412.js" type="text/javascript"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/highlight.min.js"></script>
    <script type="text/javascript">
      var _gaq=[['_setAccount','UA-56296045-1'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
    </script>
    
    <script type="text/javascript">
      hljs.initHighlightingOnLoad();
      $(".article img").addClass( "img-responsive");
      $("iframe").map( function(e) {
        $(this).css( "max-width", $(this).width() );
        $(this).width( "100%" );
      });
      var _gaq=[['_setAccount','UA-56296045-1'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
      var disqus_shortname = 'willschenk';
        var disqus_identifier = '2014-11-25-building-sites-with-middleman.html';
            
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
      (function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
    </script>
  </body>
</html>
