<!DOCTYPE html>
<html><head>
  <title>Building Sites with Middleman</title>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../../css/theme.css"/>
  <link rel="stylesheet" href="../../../css/syntax.css"/>

  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-56296045-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  <meta property="og:title" content="Building Sites with Middleman" />
<meta property="og:description" content="I make a lot of websites, and I have a certain toolkit that I use to build them. The most useful things I use are:
 layouts and partials so I only need to set things up once haml for writing html, since I don&rsquo;t like closing tags Bootstrap and sass for writing css Markdown for formatting large blogs of content coffeescript for JavaScript  Middleman is a static site generator, which means that it takes a bunch of source files, does some stuff with it, and produces static HTML, CSS, Images, and Javascript that can be hosted on a basic server somewhere, including hosting on S3 or Github Pages so you don&rsquo;t need to consider a server." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://willschenk.com/articles/2014/building-sites-with-middleman/" />
<meta property="article:published_time" content="2014-11-25T00:00:00+00:00" />
<meta property="article:modified_time" content="2014-11-25T00:00:00+00:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Building Sites with Middleman"/>
<meta name="twitter:description" content="I make a lot of websites, and I have a certain toolkit that I use to build them. The most useful things I use are:
 layouts and partials so I only need to set things up once haml for writing html, since I don&rsquo;t like closing tags Bootstrap and sass for writing css Markdown for formatting large blogs of content coffeescript for JavaScript  Middleman is a static site generator, which means that it takes a bunch of source files, does some stuff with it, and produces static HTML, CSS, Images, and Javascript that can be hosted on a basic server somewhere, including hosting on S3 or Github Pages so you don&rsquo;t need to consider a server."/>
<meta name="twitter:site" content="@wschenk"/>


  <style>
    .article p, .article ul, .article ol, .article table {
      max-width: 45em;
    }

    .article pre p {
    max-width: none;
    margin-top: -1.5rem;
    }

    article.article p:first-child, .article blockquote {
      font-size: 1.25em;
      font-weight: 300;
      max-width: 36em;  
    }
  </style>
</head>
<body><nav class="container my-5">
  <h1 class="pt-md-5 display-3"><a class="text-dark" href="../../../">Will Schenk</a></h1>
  <p>
    
      <a class="text-dark h4 mr-3 font-weight-light" href="../../../articles/" title="">Articles</a>
    
      <a class="text-dark h4 mr-3 font-weight-light" href="../../../contact" title="">Contact</a>
    
      <a class="text-dark h4 mr-3 font-weight-light" href="../../../tags/" title="">Tags</a>
    
    <a href="../../../feed.xml" class="mr-3 h4 text-light"><img src="../../../img/rss.svg" alt="rss" height="20" width="20"/></a>
    
      <a href="https://twitter.com/@wschenk" class="mr-3 h4 text-light"><img src="../../../img/twitter.svg" alt="twitter" height="20" width="20"/></a>
    
    
      <a href="https://instagram.com/wschenk" class="mr-3 h4 text-light"><img src="../../../img/instagram.svg" alt="instagram" height="20" width="20"/></a>
    
    
      <a href="https://github.com/wschenk" class="mr-3 h4 text-light"><img src="../../../img/github.svg" alt="github" height="20" width="20"/></a>
    
    
      <a href="https://linkedin.com/in/will-schenk-420266" class="mr-3 h4 text-light"><img src="../../../img/linkedin.svg" alt="linkedin" height="20" width="20"/></a>
    
  </p>
</nav>

<div class="container">
  <h1 class="mt-5">Building Sites with Middleman</h1>

  
    <h2 class="font-weight-light font-italic mb-3">lean publishing</h2>
  

  <p class="text-muted mt-3">
    <a class="text-muted" href="https://willschenk.com/articles/2014/building-sites-with-middleman/">Published November 25, 2014</a>

    
      <a class="text-muted" href="../../../tags/middleman">#middleman</a>
    
      <a class="text-muted" href="../../../tags/ruby">#ruby</a>
    
      <a class="text-muted" href="../../../tags/howto">#howto</a>
    
      <a class="text-muted" href="../../../tags/tools">#tools</a>
    
  </p>

  
  <div class="alert alert-danger">This article was published a while ago and may contain obsolete information!</div>
  

  

  <article class="article mt-5">
    <p>I make a lot of websites, and I have a certain toolkit that I use to build them.  The most useful things I use are:</p>
<ul>
<li>layouts and partials so I only need to set things up once</li>
<li><code>haml</code> for writing html, since I don&rsquo;t like closing tags</li>
<li><code>Bootstrap</code> and <code>sass</code> for writing css</li>
<li><code>Markdown</code> for formatting large blogs of content</li>
<li><code>coffeescript</code> for JavaScript</li>
</ul>
<p>Middleman is a static site generator, which means that it takes a bunch of source files, does some stuff with it, and produces static HTML, CSS, Images, and Javascript that can be hosted on a basic server somewhere, including <a href="http://docs.aws.amazon.com/AmazonS3/latest/dev/WebsiteHosting.html">hosting on S3</a> or <a href="https://pages.github.com">Github Pages</a> so you don&rsquo;t need to consider a server.</p>
<p>Middleman is written in Ruby, so it&rsquo;s our familiar toolset, and unlike <a href="http://jekyllrb.com">Jekyll</a> it uses <a href="https://github.com/sstephenson/sprockets">Sprockets</a>, which is the same asset pipelining system that Rails uses.  So you get all the benefits of using a robust system that works for Rails apps without having to learn a bunch more things.</p>
<p>In the node world <a href="http://yeoman.io">Yeoman</a> does something similar, but I personally have had poor luck getting <a href="http://gruntjs.com">Grunt</a> to work reliably in practice.</p>
<h2 id="setting-up-a-simple-static-site-with-middleman">Setting up a simple static site with Middleman</h2>
<p>One of the problems with starting with Middleman is that there are so many places to start.  Lets look at how to setup a basic middleman site with bootstrap-sass, haml, and bower.  First thing is to install middleman:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ gem install middleman
</code></pre></div><p>And create an app:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ middleman new static_site
<span class="o">[</span>...<span class="o">]</span>
      create  static_site/.gitignore
      create  static_site/config.rb
      create  static_site/source/index.html.erb
      create  static_site/source/layouts/layout.erb
      create  static_site/source/stylesheets
      create  static_site/source/stylesheets/all.css
      create  static_site/source/stylesheets/normalize.css
      create  static_site/source/javascripts
      create  static_site/source/javascripts/all.js
      create  static_site/source/images
      create  static_site/source/images/background.png
      create  static_site/source/images/middleman.png
</code></pre></div><p>This creates 4 files in the main directory, <code>Gemfile</code> and <code>Gemfile.lock</code>, which we know and love, <code>config.rb</code> which configures how middleman generates the site, and <code>source</code> which are the sourcefiles of the site.</p>
<h2 id="gemfile">Gemfile</h2>
<p>By default, <code>middleman</code> installs the <code>middleman-livereload</code> plugin, so in development mode any browers that have a page open with refresh when you save a file.  This makes testing a lot easier.  We can install other gems here to add different functionality.  Let&rsquo;s add a few of these now:</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">gem</span> <span class="s2">&#34;middleman-deploy&#34;</span>
<span class="n">gem</span> <span class="s1">&#39;middleman-bootstrap-navbar&#39;</span>
<span class="n">gem</span> <span class="s2">&#34;bootstrap-sass&#34;</span>
<span class="n">gem</span> <span class="s2">&#34;jquery-middleman&#34;</span>
</code></pre></div><p>The first two gems expand the functionality of middleman, one to add tasks to push the final site build to <code>s3</code>, <code>gh-pages</code> and a whole bunch more, and the second to make it easier to build <code>bootstrap</code> navbars.</p>
<p>The file two are including <code>bootstrap-sass</code> &ndash; the same that we use for rails sites &ndash; and <code>jquery</code>.  These get included into the sprockets asset path, so you don&rsquo;t need to maintain them in your project.  (We&rsquo;ll also see below how to integrate <code>bower</code> components into your project.)</p>
<h2 id="tweaking-middleman">Tweaking Middleman</h2>
<p><code>config.rb</code> is where we configure how middleman itself works.</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="c1"># For custom domains on github pages</span>
<span class="n">page</span> <span class="s2">&#34;CNAME&#34;</span><span class="p">,</span> <span class="ss">layout</span><span class="p">:</span> <span class="kp">false</span>

<span class="n">set</span> <span class="ss">:css_dir</span><span class="p">,</span> <span class="s1">&#39;stylesheets&#39;</span>
<span class="n">set</span> <span class="ss">:js_dir</span><span class="p">,</span> <span class="s1">&#39;javascripts&#39;</span>
<span class="n">set</span> <span class="ss">:images_dir</span><span class="p">,</span> <span class="s1">&#39;images&#39;</span>

<span class="c1"># Better markdown support</span>
<span class="c1"># set :markdown, :tables =&gt; true, :autolink =&gt; true, :gh_blockcode =&gt; true, :fenced_code_blocks =&gt; true</span>
<span class="c1"># set :markdown_engine, :redcarpet</span>

<span class="c1"># Turn this on if you want to make your url&#39;s prettier, without the .html</span>
<span class="n">activate</span> <span class="ss">:directory_indexes</span>

<span class="c1"># Automatic image dimensions on image_tag helper</span>
<span class="c1"># activate :automatic_image_sizes</span>

<span class="c1"># Easier bootstrap navbars</span>
<span class="n">activate</span> <span class="ss">:bootstrap_navbar</span>

<span class="n">configure</span> <span class="ss">:development</span> <span class="k">do</span>
  <span class="n">activate</span> <span class="ss">:livereload</span>
<span class="k">end</span>

<span class="c1"># Build-specific configuration</span>
<span class="n">configure</span> <span class="ss">:build</span> <span class="k">do</span>
  <span class="c1"># Any files you want to ignore:</span>
  <span class="n">ignore</span> <span class="s1">&#39;/admin/*&#39;</span>

  <span class="c1"># For example, change the Compass output style for deployment</span>
  <span class="n">activate</span> <span class="ss">:minify_css</span>

  <span class="c1"># Minify Javascript on build</span>
  <span class="n">activate</span> <span class="ss">:minify_javascript</span>

  <span class="c1"># Enable cache buster</span>
  <span class="n">activate</span> <span class="ss">:asset_hash</span>

  <span class="c1"># Use relative URLs</span>
  <span class="n">activate</span> <span class="ss">:relative_assets</span>
<span class="k">end</span>


<span class="c1"># This will push to the gh-pages branch of the repo, which will</span>
<span class="c1"># host it on github pages (If this is a github repository)</span>
<span class="n">activate</span> <span class="ss">:deploy</span> <span class="k">do</span> <span class="o">|</span><span class="n">deploy</span><span class="o">|</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="ss">:git</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">build_before</span> <span class="o">=</span> <span class="kp">true</span>
<span class="k">end</span>
</code></pre></div><p>Lets go through this in detail.</p>
<p><code>page &quot;CNAME&quot;, layout: false</code>  says to move the file called <code>CNAME</code> over without wrapping in the main layout.  Since this file doesn&rsquo;t have .html in the name, it would otherwise get ignored.  This file is for having a custom domain on Github Pages, if that&rsquo;s the sort of thing you are in to.</p>
<p>The <code>set</code> commands are there to configure different middleman settings, here to show where the various stylesheet, image, and css directories are.</p>
<p><code>activate :directory_indexes</code> with enable <em>pretty urls</em>.  Directory indexes means that files named <code>about.html</code> will actually get generated into a file called <code>/about/index.html</code>, and will rely on the underlying server to have <code>/about</code> actually show the directory &ldquo;index&rdquo; page, making the urls prettier.  This doesn&rsquo;t work on all servers but works on most of them.  This plugin will actually rewrite the output of the <code>link_to</code> tags, so you don&rsquo;t need to adjust your templates to work.</p>
<p><code>activate :bootstrap_navbar</code> is an extension that we added in the Gemfile, which makes it easier to generate bootstrap navbars.  Extensions generally work in three ways: they add helper methods, they change the way that the sitemap is processed, or they add different commands to the &ldquo;middleman&rdquo; command.</p>
<p>We see an example of that at the bottom of the <code>config.rb</code> file, where we configure the <code>deploy</code> extension:</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">activate</span> <span class="ss">:deploy</span> <span class="k">do</span> <span class="o">|</span><span class="n">deploy</span><span class="o">|</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="ss">:git</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">build_before</span> <span class="o">=</span> <span class="kp">true</span>
<span class="k">end</span>
</code></pre></div><p>This also takes some configuration, and in this case it set to deploy to github pages, and to make sure that it generates the site before doing so.  Here is the <a href="https://github.com/karlfreeman/middleman-deploy">middleman-deploy</a> github page with documentation.</p>
<p>There are two sections that each configure a different middleman environment.  The first is used when you run <code>middleman server</code> to look at the site locally:</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">configure</span> <span class="ss">:development</span> <span class="k">do</span>
  <span class="n">activate</span> <span class="ss">:livereload</span>
<span class="k">end</span>
</code></pre></div><p>The final section is configuring the <code>build</code> process, when you run <code>middleman build</code> and it creates the generated files in the <code>build</code> directory.  The entry below ignores certain files for the build, and runs minifiers over the css and javascript, and turns on <em>cache busting</em>.</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="c1"># Build-specific configuration</span>
<span class="n">configure</span> <span class="ss">:build</span> <span class="k">do</span>
  <span class="c1"># Any files you want to ignore:</span>
  <span class="n">ignore</span> <span class="s1">&#39;/admin/*&#39;</span>

  <span class="c1"># For example, change the Compass output style for deployment</span>
  <span class="n">activate</span> <span class="ss">:minify_css</span>

  <span class="c1"># Minify Javascript on build</span>
  <span class="n">activate</span> <span class="ss">:minify_javascript</span>

  <span class="c1"># Enable cache buster</span>
  <span class="n">activate</span> <span class="ss">:asset_hash</span>

  <span class="c1"># Use relative URLs</span>
  <span class="n">activate</span> <span class="ss">:relative_assets</span>
<span class="k">end</span>
</code></pre></div><h2 id="using-bower">Using bower</h2>
<p>The basic way to use bower is to put this in <code>config.rb</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">sprockets</span><span class="o">.</span><span class="n">append_path</span> <span class="no">File</span><span class="o">.</span><span class="n">join</span> <span class="n">root</span><span class="p">,</span> <span class="s1">&#39;bower_components&#39;</span>
</code></pre></div><p>And then you can put things in your <code>all.js</code> file like</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">//= require &#39;component&#39;
</span></code></pre></div><p>To get all of the assets that are included in the packge, you may need to specify the package in the <code>config.rb</code> file, such as:</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">sprockets</span><span class="o">.</span><span class="n">import_asset</span> <span class="s1">&#39;jquery&#39;</span>
</code></pre></div><p>More information on the <a href="http://middlemanapp.com/basics/asset-pipeline/">Middleman Asset Pipline documentation</a></p>
<h2 id="using-layouts-and-partials">Using layouts and partials</h2>
<p>The <code>source</code> directory is where the actual code for your site lives.  Here is an example <code>layouts/layout.haml</code> file to give you a sense of how to use layouts and include partials:</p>
<pre><code class="language-haml" data-lang="haml">!!! 5
%html.no-js.sticky
  %head
    %meta{ :charset =&gt; 'utf-8' }/
    %meta{ 'http-equiv' =&gt; 'X-UA-Compatible', :content =&gt; 'IE=edge,chrome=1' }/

    %title This site is amazing!

    %meta{ :name =&gt; 'description', :content =&gt; '' }/
    %meta{ :name =&gt; 'viewport', :content =&gt; 'width=device-width' }/
    = stylesheet_link_tag 'application', &quot;socicons&quot;, &quot;animate&quot;

  %body
    = partial &quot;layouts/main_header&quot;

    ~ yield

    = partial &quot;layouts/footer&quot;
    = partial &quot;layouts/javascripts&quot;
</code></pre><p>In this usage, this is similar to the way that rails layouts work.  I&rsquo;m using the <code>~</code> HAML operator inside of <code>=</code> here because I want to make sure that it doesn&rsquo;t do anything wonky with the indention on <code>&lt;pre&gt;</code> blocks, btw.</p>
<p>Middleman has a concept of nested layouts, which lets you have wrap an a layout around another one.  I think that this is confusing in practice, but as an example you could have a <code>layouts/sidebar_layout.erb</code> that looked like:</p>
<pre><code class="language-erb" data-lang="erb">&lt;% wrap_layout :layout do %&gt;
	&lt;div class=&quot;sidebar&quot;&gt;
		&lt;%= partial &quot;layouts/sidebar&quot; %&gt;
	&lt;/div&gt;

	&lt;div class=&quot;content&quot;&gt;
		&lt;%= yield %&gt;
	&lt;/div&gt;
&lt;% end %&gt;
</code></pre><h2 id="the-yaml-preable-the-preyaml">The YAML preable the preyaml</h2>
<p>Metadata about the template is included in a block of text at the top of the file, which gets pulled off to set things that the templating system can use later.  On the top of this file that I am editing right now, it looks like this</p>
<pre><code>---
title: 'Building Sites with Middleman'
subtitle: 'lean publishing'
tags: middleman, ruby, howto
header_image: books.jpg
---

I make a lot of websites, and I have a certain toolkit that I use to build...
</code></pre><p>The <code>title</code>, <code>subtitle</code>, <code>tags</code> and <code>header_image</code> attributues are available in the templates as page data, so you can access them like:</p>
<pre><code class="language-haml" data-lang="haml">  %h1= current_article.title
  %h2= current_article.data['subtitle']
</code></pre><p><em>title</em> is built into middleman, <em>subtitle</em> and <em>header image</em> are just some random things I made up.  The <code>tags</code> attribute is part of the <code>middleman-blog</code> extension which we will cover below.</p>
<h2 id="how-the-build-works">How the build works</h2>
<p>When you run <code>middleman server</code> or <code>middleman build</code>, middleman loads up the configuration file in <code>config.rb</code>.  It creates a sitemap based upon the files in the <code>source</code> directory as well as other directives inside of the config.rb file.</p>
<p>By default it only includes files like <code>.html.erb</code> and <code>.js</code>, but you can set it manually include a non-template file (like our <code>page &quot;CNAME&quot;</code> above or create other <code>proxy</code> files.  Proxy files are a way of seperating out the templates from the source data.</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="c1"># Assumes the file source/about/template.html.erb exists</span>
<span class="o">[</span><span class="s2">&#34;tom&#34;</span><span class="p">,</span> <span class="s2">&#34;dick&#34;</span><span class="p">,</span> <span class="s2">&#34;harry&#34;</span><span class="o">].</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="nb">name</span><span class="o">|</span>
  <span class="n">proxy</span> <span class="s2">&#34;/about/</span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2">.html&#34;</span><span class="p">,</span> <span class="s2">&#34;/about/template.html&#34;</span><span class="p">,</span> <span class="ss">:locals</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:person_name</span> <span class="o">=&gt;</span> <span class="nb">name</span> <span class="p">}</span>
<span class="k">end</span>
</code></pre></div><p>This creates three entries into the sitemap called <code>/about/tom.html</code>, <code>/about/dick.html</code> and <code>/about/harry.html</code> that use a specific template.</p>
<p>This data doesn&rsquo;t need to be hardcoded into the <code>config.rb</code> btw, you can also place <code>json</code> and <code>yml</code> files in the <code>data/</code> directory which middleman will load automatically.  For example, <code>data/employees.json</code></p>
<div class="highlight"><pre class="chroma"><code class="language-json" data-lang="json"><span class="p">[{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Tom&#34;</span><span class="p">,</span><span class="nt">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;Janitor&#34;</span><span class="p">},{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Mary&#34;</span><span class="p">,</span><span class="nt">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;CEO&#34;</span><span class="p">}]</span>
</code></pre></div><p>And then in your <code>config.rb</code> you could access this as:</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">data</span><span class="o">[</span><span class="s1">&#39;employees&#39;</span><span class="o">].</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">employee</span><span class="o">|</span>
  <span class="n">proxy</span> <span class="s2">&#34;/about/</span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2">.html&#34;</span><span class="p">,</span> <span class="s2">&#34;/about/template.html&#34;</span><span class="p">,</span> <span class="ss">:locals</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:person_name</span> <span class="o">=&gt;</span> <span class="n">employee</span><span class="o">[</span><span class="ss">:name</span><span class="o">]</span><span class="p">,</span> <span class="ss">:title</span> <span class="o">=&gt;</span> <span class="n">employee</span><span class="o">[</span><span class="ss">:title</span><span class="o">]</span> <span class="p">}</span>
<span class="k">end</span>
</code></pre></div><p>Then each entry in the sitemap the file is processed (based upon the extension, so scss -&gt; js, haml -&gt; html, etc.) into the build directory.  Helper methods are available inside of the templates for things like <code>javascript_include_tag</code>, <code>stylesheet_link_tag</code>, <code>link_to</code> and <code>image_tag</code> and all of the rest.</p>
<h2 id="middleman-server">middleman server</h2>
<p>Starting the server in preview mode will start a local server on port <code>4567</code> that generates the files on demand.  If you have livereload enabled this will automatically trigger a page refresh for any open browsers, so you can tweak and look at things as you go.</p>
<p>Inside of your templates, <code>config.environment == :development</code> when you are in preview mode.  So, if there are some things that you don&rsquo;t want to push to the live site but are useful for development, you can switch them on and off using that mechanism.</p>
<h2 id="middleman-build">middleman build</h2>
<p>This does basically the same thing as the server, but the templates are generally further processed.  Cachebusting can be enabled, and you can include tracking code if <code>config.environment == :build</code> is true.  This goes through all of the files in source that look like webfiles and places them in the <code>build</code> directory.</p>
<p>And easy way to check out what you have there is by <code>cd</code>ing into the <code>build/</code> directory and running a simple webserver to serve the pages.  Relative links don&rsquo;t work when you open the file directly in the browser, so you need to use an actual webserver.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nb">cd</span> build
$ python -m SimpleHTTPServer
</code></pre></div><p>And then open a new browser on port <code>8000</code>.</p>
<h2 id="middleman-deploy">middleman deploy</h2>
<p>In the basic <code>:git</code> setting that we have above, middleman deploy will build the site into the <code>build/</code> directory, switch that directory to the <code>gh-pages</code> branch, and push it to <code>origin</code>.  Assuming that you are hosting your repo on github, this will publish the static content on github pages.</p>
<p>If you want to use a <a href="https://help.github.com/articles/setting-up-a-custom-domain-with-github-pages/">custom domain</a> then you need to create a <code>CNAME</code> file in <code>source/</code> with the domain name, and set up your DNS records to match.</p>
<p>One thing to note is that while changes to the pages seem to deploy quickly, it takes a long time for the first push to github pages to show up, on the order of 10-15 minutes.</p>
<p>More information on <a href="https://github.com/karlfreeman/middleman-deploy">middleman-deploy</a>.</p>
<h2 id="building-a-blog">Building a blog</h2>
<p>There are two good extensions for building a blog with middleman.  The default template for blog is sort of confusing in the way that it&rsquo;s laid out, mainly because it gets rid of the <code>layouts/</code> directory, but let&rsquo;s go through it and see how it&rsquo;s supposed to work:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ gem install middleman-blog
$ middleman new static_blog --template<span class="o">=</span>blog
      create  static_blog/.gitignore
      create  static_blog/config.rb
      create  static_blog/source
      create  static_blog/source/2012-01-01-example-article.html.markdown
      create  static_blog/source/calendar.html.erb
      create  static_blog/source/feed.xml.builder
      create  static_blog/source/index.html.erb
      create  static_blog/source/layout.erb
      create  static_blog/source/tag.html.erb
      create  static_blog/source/stylesheets
      create  static_blog/source/javascripts
      create  static_blog/source/images
</code></pre></div><p>Now we have another middleman site, with a bunch of files.  It also creates a new command:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ middleman article <span class="s2">&#34;This is the title of my article&#34;</span>
</code></pre></div><p>Let&rsquo;s also include the <code>middleman-blog-drafts</code> gem into the <code>Gemfile</code>, <code>activate :drafts</code> in `config.rb, and that will give us a few more commands:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ middleman draft <span class="s2">&#34;This is amazing&#34;</span>
      create  source/drafts/this-is-amazing.html.markdown
$ middleman publish source/drafts/this-is-amazing.html.markdown
      create  source/2014-11-25-this-is-amazing.html.markdown
      remove  source/drafts/this-is-amazing.html.markdown
</code></pre></div><p>This lets us keep drafts in git and doesn&rsquo;t force us to commit to a date until we are ready to publish it.  There are <code>published</code> and <code>date</code> attributes that the default blog extension knows about to turn it on and off, and is a good example of something that you can see in development but not production, but that still leaves to moving files around manually to adjust the date.</p>
<h2 id="what-does-it-add">What does it add</h2>
<p>In addition to the sitemap, we now have a <code>blog</code>, <code>article</code>, and <code>tag</code> concept inside of the middleman app.  Articles are represented as pages (by default using <code>markdown</code>) but the <code>tag</code> and <code>calendar</code> templates are actually more like <code>proxy</code> templates than file templates, and when the site is generated middleman will iterate over then to produce many output files from one template.</p>
<p>Part of the <code>index.html.haml</code> of this site looks like:</p>
<pre><code class="language-haml" data-lang="haml">  - (drafts + page_articles).each do |article|
    .post
      .post-date
        - unless article.is_a? ::Middleman::Blog::Drafts::DraftArticle
          %p= article.date.strftime( '%b %e' )
        - else
          %p.draft Draft
</code></pre><p>I&rsquo;m putting all of the articles in a list, both drafts and published ones, and only showing the date for articles which have already been published.</p>
<p>Here&rsquo;s what gets added to the <code>config.rb</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">activate</span> <span class="ss">:blog</span> <span class="k">do</span> <span class="o">|</span><span class="n">blog</span><span class="o">|</span>
  <span class="c1"># This will add a prefix to all links, template references and source paths</span>
  <span class="c1"># blog.prefix = &#34;blog&#34;</span>

  <span class="c1"># blog.permalink = &#34;{year}/{month}/{day}/{title}.html&#34;</span>
  <span class="c1"># Matcher for blog source files</span>
  <span class="c1"># blog.sources = &#34;{year}-{month}-{day}-{title}.html&#34;</span>
  <span class="c1"># blog.taglink = &#34;tags/{tag}.html&#34;</span>
  <span class="c1"># blog.layout = &#34;layout&#34;</span>
  <span class="c1"># blog.summary_separator = /(READMORE)/</span>
  <span class="c1"># blog.summary_length = 250</span>
  <span class="c1"># blog.year_link = &#34;{year}.html&#34;</span>
  <span class="c1"># blog.month_link = &#34;{year}/{month}.html&#34;</span>
  <span class="c1"># blog.day_link = &#34;{year}/{month}/{day}.html&#34;</span>
  <span class="c1"># blog.default_extension = &#34;.markdown&#34;</span>

  <span class="n">blog</span><span class="o">.</span><span class="n">tag_template</span> <span class="o">=</span> <span class="s2">&#34;tag.html&#34;</span>
  <span class="n">blog</span><span class="o">.</span><span class="n">calendar_template</span> <span class="o">=</span> <span class="s2">&#34;calendar.html&#34;</span>

  <span class="c1"># Enable pagination</span>
  <span class="c1"># blog.paginate = true</span>
  <span class="c1"># blog.per_page = 10</span>
  <span class="c1"># blog.page_link = &#34;page/{num}&#34;</span>
<span class="k">end</span>

<span class="n">activate</span> <span class="ss">:drafts</span>
</code></pre></div><p>This should be enough to get you started, and more <a href="http://middlemanapp.com/basics/blogging/">documentation is here</a> .  At this point it really becomes a design and development challenge, not figuring out how to use the tool.</p>
<h2 id="go-get-started">Go get started</h2>
<p>Middleman gives you all of the front-end developer benefits of using a system like Rails, but outputs static content than can be served anywhere without any dependancies.  Many sites don&rsquo;t really require all that for them to run, and it&rsquo;s crazy to me that something as read heavy as a blog often can&rsquo;t perform well under load given that it&rsquo;s just serving up the same old stuff over and over again.  You want to have some tooling to make it easier, but it doesn&rsquo;t need to be <em>run time</em> tooling.</p>
<p><em>Image Credit: <a href="https://www.flickr.com/photos/aigle_dore/6365101775/in/photolist-aGsP14-7PozJp-84P71r-dphot9-5qz3ks-eqHuv-6NP8d6-HdurS-aibaen-ix8Rbz-6buevW-7acJMF-8DFBf3-MLnGM-dGa2xi-f4HeM7-zXqL6-88og6h-r7w3U-2qKgwi-mcp7h-4eXcGM-9uv3gC-7BAEiV-5RzRtp-7JKRHh-6iUdMZ-2bUDT-8s4PDi-8pvSWc-dynb6k-zV2x5-4xWMzG-dsxGqc-7Cby3b-9t3zWm-b4jsc2-8YyqSQ-9ggca5-aGsPSg-68SVDi-4PNHrt-7JGpz4-aL22G2-q1ic-sZMVW-84NAEC-8JBSSW-9k6cM-89NBaJ">Moyan Brenn</a></em></p>

  </article>

  
</div>


  <div class="bg-light py-5">
    <div class="container">
      <h2 class="text-center">Read next</h2>

      <div class="row">
        <div class="col-md-6 text-center">
          
            Next Post:
            <a href="../../../articles/2014/new-happyseed-released/">New HappySeed released</a>
          
        </div>
        <div class="col-md-6 text-center">
          
            Previous Post:
            <a href="../../../articles/2014/scripting-twitter/">Scripting Twitter: Collecting Data and Writing Bots</a>
          
        </div>
      </div>
    </div>
  </div>




<div class="container mt-5">
  <h2 class="text-center">See also</h2>
  <div class="row">
  	
      <div class="col-md mb-3">
        <p class="lead mb-0"><a class="text-body" href="../../../articles/2014/scripting-twitter/">Scripting Twitter: Collecting Data and Writing Bots</a></p>

        
          <p class="lead font-italic mb-0">adding another client to socialinvestigator</p>
        
        <div class="font-weight-light mt-3">
          
          
            <p>Lets build on our command line url exploring tool to look at how we can interact with Twitter. We are going to cover how to make a script that will pull information out of twitter, how to deal with its rate limiting, and how to interact with users on Twitter itself.
Twitter uses OAuth 1.0A as a way to authenticate requests. As a script writer, this is super annoying, because you can&rsquo;t just stick a username and password in the environment and go from there.</p>
          
        </div>
        <a href="../../../articles/2014/scripting-twitter/" class="btn btn-primary">Read more</a>
      </div>
    
      <div class="col-md mb-3">
        <p class="lead mb-0"><a class="text-body" href="../../../articles/2014/making-a-command-line-utility-with-gems-and-thor/">Making a command line utility with gems and thor</a></p>

        
          <p class="lead font-italic mb-0">Any excuse to the use the phrase &ldquo;Hammer of the Gods&rdquo;</p>
        
        <div class="font-weight-light mt-3">
          
          
            <p>Some scripts work well because they are self contained and don&rsquo;t have a lot of dependancies, like the hosts on your network tracker.
Others scripts
 have more code than fits into a single file multiple options and switches have an extensive set of dependancies  And on those cases, its better to make a gem and use thor
Hammer of the Gods Lets figure out how to make some command line tools and package them up so that they can be shared and used by other people.</p>
          
        </div>
        <a href="../../../articles/2014/making-a-command-line-utility-with-gems-and-thor/" class="btn btn-primary">Read more</a>
      </div>
    
      <div class="col-md mb-3">
        <p class="lead mb-0"><a class="text-body" href="../../../articles/2014/how-to-track-your-coworkers/">How to track your coworkers</a></p>

        
          <p class="lead font-italic mb-0">Simple passive network surveillance</p>
        
        <div class="font-weight-light mt-3">
          
          
            <p>How much information do you bleed?
Ever wonder who is else is using your network? Or,who has actually showed up at the office?
Networking primer The simplest thing we can do to make this work is to check to see which devices have registered themselves on the network. As devices come and go, they connect automatically, so we will have a pretty good idea if people are there or not. Phones seem to attach and detach quite frequency, probably to conserve battery, so if we are want to answer the question &ldquo;is so-and-so in the office&rdquo; we&rsquo;ll need to add additional logic to determine how far spaced the &ldquo;sighting&rdquo; events are to mean that the person has left the office, rather than the phone has gone to sleep.</p>
          
        </div>
        <a href="../../../articles/2014/how-to-track-your-coworkers/" class="btn btn-primary">Read more</a>
      </div>
    
  </div>
</div>


<footer class="footer bg-dark text-light mt-3">
  <div class="container">
    <h2 class="py-5 font-weight-light my-0">Made in Brooklyn, NY.</h2>
  </div>
</footer>
</body>
</html>
