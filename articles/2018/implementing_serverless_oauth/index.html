<!DOCTYPE html>
<html><head>
  <title>Implementing Serverless OAuth</title>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../../css/theme.css"/>
  
  <link rel="stylesheet" href="../../../css/syntax.css"/>

  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-56296045-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  <meta property="og:title" content="Implementing Serverless OAuth" />
<meta property="og:description" content="Most of the serverless platforms have their own forms of authentication, but it might not support the specific service that you are looking to use. Lets go through how we can build a react single page app, hosting on firebase, that talks to the unsplash service directly. It will be hosted on firebase stoage, and with a tiny bit of firebase functions to tie it together.
How oauth works Here is the overall process:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://willschenk.com/articles/2018/implementing_serverless_oauth/" /><meta property="article:published_time" content="2018-11-12T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2018-11-12T00:00:00&#43;00:00"/>

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Implementing Serverless OAuth"/>
<meta name="twitter:description" content="Most of the serverless platforms have their own forms of authentication, but it might not support the specific service that you are looking to use. Lets go through how we can build a react single page app, hosting on firebase, that talks to the unsplash service directly. It will be hosted on firebase stoage, and with a tiny bit of firebase functions to tie it together.
How oauth works Here is the overall process:"/>
<meta name="twitter:site" content="@wschenk"/>


  <style>
    .article p, .article ul, .article ol, .article table {
      max-width: 45em;
    }

    article.article p:first-child, .article blockquote {
      font-size: 1.25em;
      font-weight: 300;
      max-width: 36em;  
    }
  </style>
</head>
<body><nav class="container my-5">
  <h1 class="pt-5 display-3"><a class="text-dark" href="../../../">Will Schenk</a></h1>
  <p>
    
      <a class="text-dark h4 mr-3 font-weight-light" href="../../../articles/" title="">Articles</a>
    
      <a class="text-dark h4 mr-3 font-weight-light" href="../../../contact" title="">Contact</a>
    
      <a class="text-dark h4 mr-3 font-weight-light" href="../../../tags/" title="">Tags</a>
    
    <a href="../../../feed.xml" class="mr-3 h4 text-light"><img src="../../../img/rss.svg" alt="rss" height="20" width="20"/></a>
    
      <a href="https://twitter.com/@wschenk" class="mr-3 h4 text-light"><img src="../../../img/twitter.svg" alt="twitter" height="20" width="20"/></a>
    
    
      <a href="https://instagram.com/wschenk" class="mr-3 h4 text-light"><img src="../../../img/instagram.svg" alt="instagram" height="20" width="20"/></a>
    
    
      <a href="https://linkedin.com/in/will-schenk-420266" class="mr-3 h4 text-light"><img src="../../../img/linkedin.svg" alt="linkedin" height="20" width="20"/></a>
    
  </p>
</nav>

<div class="container">
  <h1 class="mt-5">Implementing Serverless OAuth</h1>

  
    <h2 class="font-weight-light font-italic mb-3">for JAM Stacks and static sites</h2>
  

  <p class="text-muted mt-3">
    <a class="text-muted" href="https://willschenk.com/articles/2018/implementing_serverless_oauth/">Published November 12, 2018</a>

    
      <a class="text-muted" href="../../../tags/howto">#howto</a>
    
      <a class="text-muted" href="../../../tags/static_sites">#static_sites</a>
    
      <a class="text-muted" href="../../../tags/functions">#functions</a>
    
      <a class="text-muted" href="../../../tags/firebase">#firebase</a>
    
  </p>

  

  <article class="article mt-5">
    

<p>Most of the serverless platforms have their own forms of authentication, but it might not support the specific service that you are looking to use.  Lets go through how we can build a react single page app, hosting on firebase, that talks to the unsplash service directly.  It will be hosted on firebase stoage, and with a tiny bit of firebase functions to tie it together.</p>

<h2 id="how-oauth-works">How oauth works</h2>

<p>Here is the overall process:</p>

<p><img src="oauth.sequence.svg" alt="sequence flow" class="img-fluid"/></p>

<p>There are 3 entities &ndash; the user&rsquo;s browser, our server, and the third party service.</p>

<ol>
<li>On user action, such as pressing a Log in With Google button, a request is made to your server.</li>
<li>A signed request is generated which includes the access levels that we wish to be granted.  The client ID and client secret, which are provided by the service provider (under something like Create An App) are used to sign this request so that the server knows which app is requesting permission.</li>
<li>The browser is redirected to the third party service with this request.</li>
<li>The user interacts with the third party service, and grants us the permission.</li>
<li>The browser is redirected to the &ldquo;call back url&rdquo;, which is generally needs to be white listed at the same place you got your client id and secrets.</li>
<li>The authcode is then used by our server to request an access_token from the service.  authcode are very short lived so prevent play back attacks since they are exposed to the browser.  Access tokens are longer lived and aren&rsquo;t generally exposed to the browser.</li>
<li>The server (optionally) gets information for the account, for example name and avatar photos, to configure a local account.</li>
<li>A logged in version of the site is returned to the user&rsquo;s browser.</li>
</ol>

<p>In this scenario:</p>

<ol>
<li>The user&rsquo;s password is never seen by our server.</li>
<li>The user doesn&rsquo;t need to remember yet another password for your site.</li>
<li>The access token is never seen by the user.</li>
<li>Access Tokens can be revoked by the third-party service at any time.</li>
<li>Access Tokens can be tied to a developer, so bad actors on the server level can be locked out.</li>
<li>The third party service can grant fine grained control of what data they grant access to.</li>
</ol>

<h2 id="what-do-we-need-to-implement">What do we need to implement</h2>

<ol>
<li>A client ID from the third party service.</li>
<li>A client secret from the third party service.</li>
<li>An auth method to contruct the initial requests.</li>
<li>An auth_callback method to process the final request.</li>
<li>An auth callback url that is granted access by the third party service&rsquo;s app configuration.</li>
</ol>

<p>The first 2 are created at a third party service.  For this example, I&rsquo;m going to choose <a href="https://firebase.google.com/">firebase</a> to host our functions and website, and <a href="https://unsplash.com/developers">Unsplash</a> since it&rsquo;s a pretty fun third-party service that&rsquo;s a bit off the beaten path and its not too hard to get an app registered.</p>

<h3 id="create-the-app-on-the-third-party-service">Create the app on the third party service</h3>

<p>Go ahead and follow that the unsplash link and register as a developer.</p>

<p>Then press the big <code>New Application</code> button and verify that you are going to follow the rules.  Give your application a name and a quick description, then create!</p>

<p>Note your Application Key and Secret.  This could aslo be called your client id and secret.  We&rsquo;ll need those later.  Set your callback url to <code>https://localhost:3000/auth_callback</code>.  Once we deploy to firebase we&rsquo;ll need to go back with our actual URL, but this is what we&rsquo;ll use fore testing.</p>

<h3 id="create-our-javascript-template">Create our javascript template</h3>

<p>We are going to use <code>create-react-app</code> and then going to add firebase to it.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ npx create-react-app unsplash-test
$ <span class="nb">cd</span> unsplash-test</code></pre></div>
<h3 id="setup-firebase">Setup firebase</h3>

<p>Now we setup our &ldquo;server&rdquo; on the <a href="https://console.firebase.google.com/u/0/">FireBase console</a>  Create a new application.  Select the web integration, and copy the example config into <code>src/firebaseConfig.js</code>, something like below:</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">config</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">apiKey</span><span class="o">:</span> <span class="s2">&#34;AIzY....&#34;</span><span class="p">,</span>
  <span class="nx">authDomain</span><span class="o">:</span> <span class="s2">&#34;honey-b6642.firebaseapp.com&#34;</span><span class="p">,</span>
  <span class="nx">databaseURL</span><span class="o">:</span> <span class="s2">&#34;https://honey-b6642.firebaseio.com&#34;</span><span class="p">,</span>
  <span class="nx">projectId</span><span class="o">:</span> <span class="s2">&#34;honey-b6642&#34;</span><span class="p">,</span>
  <span class="nx">storageBucket</span><span class="o">:</span> <span class="s2">&#34;honey-b6642.appspot.com&#34;</span><span class="p">,</span>
  <span class="nx">messagingSenderId</span><span class="o">:</span> <span class="s2">&#34;847930143737&#34;</span>
<span class="p">};</span>
</code></pre></div>
<p>If you haven&rsquo;t already, it&rsquo;s time to install the <code>firebase-tools</code> page.  I&rsquo;m using yarn here:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ yarn global add firebase-tools</code></pre></div>
<p>And then lets add firebase to our project:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ yarn add firebase
$ firebase login
$ firebase init</code></pre></div>
<p>This will first prompt you to login to firebase so your machine has development credentials.  Then <code>init</code> will configure your local project with the correct configuration.</p>

<ol>
<li>Select at least functions and hosting.</li>
<li>Choose the application that you just created.</li>
<li>I chose JavaScript instead of TypeScript.</li>
<li>Yes to ESLint.</li>
<li>Yes to install dependencies.</li>
<li><code>build</code> as the hosting directory.</li>
<li>Yes to single page app.</li>
<li>No to overwriting <code>index.html</code> if asked.</li>
</ol>

<p>Firebase should now be configured.  Lets do a quick test of the deploy.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ yarn run build <span class="c1"># Build the sample create-react-app project</span>
$ firebase deploy <span class="c1"># Push everything to firebase</span></code></pre></div>
<p>And open your browser to the url that was <code>firebase deploy</code> spit out at the end.  If you see a blank screen, double check that in <code>firebase.json</code> you have <code>build</code> set as the <code>public</code> directory in hosting.</p>

<h3 id="set-the-secrets-for-your-firebase-functions">Set the secrets for your firebase functions</h3>

<p>We are going to store the oauth secrets inside of firebase to keep them seperate from your code. These are the application id and application secret that we got from unsplash above that you should have taken note off.  Lets set those in firebase now (and be sure you enter in your own secrets!)</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ firebase functions:config:set oauth.client_id<span class="o">=</span>yourclientid
$ firebase functions:config:set oauth.client_secret<span class="o">=</span>yourclientsecret</code></pre></div>
<p>We can then pull these secrets back down locally into a firebase env file so that when we are testing out our firebase code it will behave like it will in production.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ firebase functions:config:get &gt; functions/.runtimeconfig.json</code></pre></div>
<p>We don&rsquo;t want these files to go into git so</p>

<pre><code>$ echo functions/.runtimeconfig.json &gt;&gt; .gitignore
</code></pre>

<h3 id="setup-firebase-functions">Setup firebase functions</h3>

<p>Lets go into the <code>functions</code> directory and add a few npm modules.  One for the http, and the other for the oauth flow.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nb">cd</span> functions
$ yarn add express</code></pre></div>
<p>Now lets create a simple app that we can use to test out our install.  Replace <code>functions/index.js</code> with:</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="k">const</span> <span class="nx">functions</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;firebase-functions&#39;</span><span class="p">);</span>
<span class="k">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>

<span class="k">const</span> <span class="nx">oauth</span> <span class="o">=</span> <span class="nx">functions</span><span class="p">.</span><span class="nx">config</span><span class="p">().</span><span class="nx">oauth</span><span class="p">;</span>
<span class="k">const</span> <span class="nx">webApp</span> <span class="o">=</span> <span class="nx">express</span><span class="p">()</span>

<span class="nx">webApp</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s1">&#39;/auth&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>

  <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span> <span class="s2">&#34;my client id is: &#34;</span> <span class="o">+</span> <span class="nx">oauth</span><span class="p">.</span><span class="nx">client_id</span>  <span class="p">)</span>
<span class="p">})</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">oauth</span> <span class="o">=</span> <span class="nx">functions</span><span class="p">.</span><span class="nx">https</span><span class="p">.</span><span class="nx">onRequest</span><span class="p">(</span> <span class="nx">webApp</span> <span class="p">)</span>
</code></pre></div>
<p>Then run <code>firebase serve --only functions</code> to start up the api locally.  Be sure to check out the url that the proxy code is running on.  In my case, it&rsquo;s <code>http://localhost:5001/honey-b6642/us-central1/oauth</code>.  Once this is running you should be able to go to the url listed and see the client id from the configuration.</p>

<h2 id="setup-the-react-app">Setup the react app</h2>

<p>We need to point our react code to our firebase functions, and we are going to put that information into <code>env</code> files so that there is one place to swap them out later.  These need to be prefaced with <code>REACT_APP_</code> in order to play well with the <code>create-react-app</code> build process. Create a <code>.env.development</code> file with your information in it</p>

<pre><code>REACT_APP_BASE_URL=&quot;http://localhost:5001/honey-b6642/us-central1/oauth&quot;
</code></pre>

<p>We also don&rsquo;t want this file in source control:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nb">echo</span> .env.development &gt;&gt; .gitignore</code></pre></div>
<p>Once we deploy the server to fire base, we can point this to our production instances.  Also, we will create another <code>.env.production</code> file for build time information.  Note that we don&rsquo;t want the oauth secrets here, since this is for the JavaScript code, not for the server functions.</p>

<p>First lets add some small styling to that our eyes won&rsquo;t hurt during development.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ yarn add node-sass bootstrap reactstrap dotenv</code></pre></div>
<p>Rename <code>src/index.css</code> to <code>src/index.scss</code>, and include the bootstrap sass files.  This is a bit overkill at the moment, but it will set things up for easy customization going forward.</p>
<div class="highlight"><pre class="chroma"><code class="language-scss" data-lang="scss"><span class="k">@import</span> <span class="s2">&#34;~bootstrap/scss/bootstrap.scss&#34;</span></code></pre></div>
<p>Be sure to update <code>src/index.js</code> to point to the correct style sheet, change <code>index.css</code> to <code>index.scss</code></p>

<p>Now we can build out a scaffolding for <code>src/App.js</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-jsx" data-lang="jsx"><span class="k">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Jumbotron</span><span class="p">,</span> <span class="nx">Container</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;reactstrap&#39;</span><span class="p">;</span>


<span class="k">const</span> <span class="nx">LoginWindow</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">Jumbotron</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">Container</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h1</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;display-3&#34;</span><span class="p">&gt;</span><span class="nx">Unsplash</span> <span class="nx">browser</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;lead&#34;</span><span class="p">&gt;</span><span class="nx">This</span> <span class="nx">is</span> <span class="nx">an</span> <span class="nx">example</span> <span class="k">of</span> <span class="nx">how</span> <span class="nx">to</span> <span class="k">do</span> <span class="nx">something</span> <span class="nx">amazing</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;btn btn-primary&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">{process.env.REACT_APP_BASE_URL</span> <span class="err">+</span> <span class="err">&#34;/</span><span class="na">auth</span><span class="err">&#34;</span><span class="p">}&gt;</span><span class="nx">Connect</span><span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">Container</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">Jumbotron</span><span class="p">&gt;</span>
  <span class="p">)</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nx">App</span> <span class="k">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nt">LoginWindow</span><span class="p">/&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">App</span><span class="p">;</span></code></pre></div>
<p>Now start up the server using <code>yarn start</code>, and press the <code>Connect</code> button.  You should now see the response from the firebase function running locally!</p>

<h2 id="implementing-the-oauth-flow">Implementing the OAuth Flow</h2>

<p>Now that all the pieces are in place, it&rsquo;s time to start implementing the oauth logic inside of the firebase functions.</p>

<p>First lets add a few libraries to the <code>functions/package.json</code>:</p>

<pre><code>$ cd functions
$ yarn add simple-oauth2 randomstring
</code></pre>

<p>Also edit the local <code>functions/.runtimeconfig.json</code> to include the callback url that we are going to pass to unsplash.  Mine looks like:</p>
<div class="highlight"><pre class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&#34;oauth&#34;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&#34;client_secret&#34;</span><span class="p">:</span> <span class="s2">&#34;56efa3a9c3ddc8ff50beab6.....&#34;</span><span class="p">,</span>
    <span class="nt">&#34;client_id&#34;</span><span class="p">:</span> <span class="s2">&#34;d69d777a78a53b95523cc4cbf.....&#34;</span><span class="p">,</span>
    <span class="nt">&#34;redirect_uri&#34;</span><span class="p">:</span> <span class="s2">&#34;http://localhost:5000/honey-b6642/us-central1/oauth/callback&#34;</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></div>
<p>Now lets write some code! Lets replace what we have in <code>functions/index.js</code> with a method to create a authorization request to unplash and then redirect the user&rsquo;s browser to it.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="k">const</span> <span class="nx">functions</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;firebase-functions&#39;</span><span class="p">);</span>
<span class="k">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>
<span class="k">const</span> <span class="nx">simpleOauth</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;simple-oauth2&#39;</span><span class="p">);</span>
<span class="k">const</span> <span class="nx">randomstring</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;randomstring&#39;</span><span class="p">);</span>

<span class="k">const</span> <span class="nx">oauth</span> <span class="o">=</span> <span class="nx">functions</span><span class="p">.</span><span class="nx">config</span><span class="p">().</span><span class="nx">oauth</span><span class="p">;</span>
<span class="k">const</span> <span class="nx">webApp</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>

<span class="k">const</span> <span class="nx">oauth2</span> <span class="o">=</span> <span class="nx">simpleOauth</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="nx">client</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">id</span><span class="o">:</span> <span class="nx">oauth</span><span class="p">.</span><span class="nx">client_id</span><span class="p">,</span>
    <span class="nx">secret</span><span class="o">:</span> <span class="nx">oauth</span><span class="p">.</span><span class="nx">client_secret</span>
  <span class="p">},</span>
  <span class="nx">auth</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">tokenHost</span><span class="o">:</span> <span class="s1">&#39;https://unsplash.com/&#39;</span><span class="p">,</span>
    <span class="nx">tokenPath</span><span class="o">:</span> <span class="nx">oauth</span><span class="p">.</span><span class="nx">token_path</span> <span class="o">||</span> <span class="s1">&#39;/oauth/token&#39;</span><span class="p">,</span>
    <span class="nx">authorizePath</span><span class="o">:</span> <span class="nx">oauth</span><span class="p">.</span><span class="nx">authorize_path</span> <span class="o">||</span> <span class="s1">&#39;/oauth/authorize&#39;</span>
  <span class="p">}</span>
<span class="p">})</span>

<span class="nx">webApp</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/auth&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">const</span> <span class="nx">authorizationUri</span> <span class="o">=</span> <span class="nx">oauth2</span><span class="p">.</span><span class="nx">authorizationCode</span><span class="p">.</span><span class="nx">authorizeURL</span><span class="p">({</span>
    <span class="nx">redirect_uri</span><span class="o">:</span> <span class="nx">oauth</span><span class="p">.</span><span class="nx">redirect_uri</span><span class="p">,</span>
    <span class="nx">scope</span><span class="o">:</span> <span class="nx">oauth</span><span class="p">.</span><span class="nx">scopes</span> <span class="o">||</span> <span class="s1">&#39;public&#39;</span><span class="p">,</span>
    <span class="nx">state</span><span class="o">:</span> <span class="nx">randomstring</span><span class="p">.</span><span class="nx">generate</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
  <span class="p">})</span>

  <span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="nx">authorizationUri</span><span class="p">)</span>
<span class="p">})</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">oauth</span> <span class="o">=</span> <span class="nx">functions</span><span class="p">.</span><span class="nx">https</span><span class="p">.</span><span class="nx">onRequest</span><span class="p">(</span> <span class="nx">webApp</span> <span class="p">)</span>
</code></pre></div>
<p>First we setup <code>simpleOauth</code>.  We are using the configuration id and secret that we got from unsplash, and the endpoints that are specified in the documentation for the <code>token</code> and <code>authorize</code> path.  When we get a <code>/auth</code> request we use create an authorization request using that configuration and then redirect the browser to it.</p>

<p>We haven&rsquo;t written a callback handler yet, but lets try it out.  First go to <a href="https://unsplash.com/">unsplash</a> and log out of your account to see the whole flow.  Then go to <a href="http://localhost:3000">http://localhost:3000</a> and press the auth button.  You&rsquo;ll be prompted to log in, and when you do you should see:</p>

<p><img src="unsplash_auth.png" class="img-fluid"/></p>

<p>If you don&rsquo;t, a couple of things to check</p>

<ul>
<li>Is your client id and secret being set correctly?</li>
<li>Is your redirect_uri configured correctly?</li>
<li>Are you passing the correct scope? (In this case, <code>public</code>)</li>
</ul>

<p>OK, now it&rsquo;s time to write the callback method!</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">webApp</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/callback&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">req</span><span class="p">.</span><span class="nx">query</span> <span class="p">);</span>

  <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">code</span><span class="o">:</span> <span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">code</span><span class="p">,</span>
    <span class="nx">scope</span><span class="o">:</span> <span class="nx">oauth</span><span class="p">.</span><span class="nx">scopes</span> <span class="o">||</span> <span class="s1">&#39;public&#39;</span><span class="p">,</span>
    <span class="nx">redirect_uri</span><span class="o">:</span> <span class="nx">oauth</span><span class="p">.</span><span class="nx">redirect_uri</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">oauth2</span><span class="p">.</span><span class="nx">authorizationCode</span><span class="p">.</span><span class="nx">getToken</span><span class="p">(</span><span class="nx">options</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">result</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">oauth2</span><span class="p">.</span><span class="nx">accessToken</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span>

    <span class="c1">// We could also ask unplash about the user profile here if we wanted
</span><span class="c1"></span>    <span class="c1">// to setup a firebase user for this authorization
</span><span class="c1"></span>    <span class="nx">res</span><span class="p">.</span><span class="nx">setHeader</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="nx">token</span><span class="o">:</span> <span class="nx">token</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">access_token</span> <span class="p">}));</span>
  <span class="p">}).</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Access Token Error&#39;</span><span class="p">,</span> <span class="nx">error</span><span class="p">.</span><span class="nx">messsage</span><span class="p">)</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span> <span class="nx">error</span> <span class="p">)</span>
  <span class="p">})</span>
<span class="p">})</span>
</code></pre></div>
<p>When you press &ldquo;Grant Access&rdquo; on Unsplash, it will generate an authorization code and redirect the user&rsquo;s browser back to this function.  Here we use that code to get an access token from unsplash that we can then use to make requests on the user&rsquo;s behalf.</p>

<h2 id="using-the-token">Using the token</h2>

<p>In the scenario we outlined at the top, the server would store the access_token and connect to the server with authenticated requests from there.  In the case of firebase, we&rsquo;d great something like an Anaonymous account, store the token there, and then proxy requests from the server to the third party service never exposing the access_token to the browser.  This is a clean way to do this so that the access_token is never exposed.</p>

<p>But it makes it more complicated, so we are going to hack through it for demo purposes to just finish up the demo.  The code that we are writing is going to connect to the unsplash api from the browser directly, so we&rsquo;ll change our fireback function code to redirect back to our static app with an url that contains the access_token.</p>

<p>So, lets have the code redirect back to our react site with the query string as the parameter.</p>

<p>First lets add where we&rsquo;d like it to go to the configuration in <code>functions/.runtimeconfig.json</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&#34;oauth&#34;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&#34;client_secret&#34;</span><span class="p">:</span> <span class="s2">&#34;56efa3a9c3ddc8ff50beab69bd530....&#34;</span><span class="p">,</span>
    <span class="nt">&#34;client_id&#34;</span><span class="p">:</span> <span class="s2">&#34;d69d777a78a53b95523cc4cbf8921....&#34;</span><span class="p">,</span>
    <span class="nt">&#34;redirect_uri&#34;</span><span class="p">:</span> <span class="s2">&#34;http://localhost:5000/honey-b6642/us-central1/oauth/callback&#34;</span><span class="p">,</span>
    <span class="nt">&#34;static_site_url&#34;</span><span class="p">:</span> <span class="s2">&#34;http://localhost:3000&#34;</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></div>
<p>Then lets change our function to redirect instead of spitting out json.  So in <code>functions/index.js</code> change:</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js">    <span class="nx">res</span><span class="p">.</span><span class="nx">setHeader</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="nx">token</span><span class="o">:</span> <span class="nx">token</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">access_token</span> <span class="p">}));</span>
</code></pre></div>
<p>to:</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js">    <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span> <span class="nx">oauth</span><span class="p">.</span><span class="nx">static_site_url</span> <span class="o">+</span> <span class="s2">&#34;?access_token=&#34;</span> <span class="o">+</span><span class="nx">token</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">access_token</span> <span class="p">);</span>
</code></pre></div>
<p>Now we need to update our react code so that it knows what to do with that access token.  Lets first add a node module that understands how to parse query strings:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ yarn add query-string</code></pre></div>
<p>And replace the App class in <code>src/App.js</code> with the following:</p>
<div class="highlight"><pre class="chroma"><code class="language-jsx" data-lang="jsx"><span class="k">class</span> <span class="nx">App</span> <span class="k">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">state</span> <span class="o">=</span> <span class="p">{</span><span class="nx">access_token</span><span class="o">:</span><span class="kc">null</span><span class="p">}</span>

  <span class="nx">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">const</span> <span class="nx">values</span> <span class="o">=</span> <span class="nx">QueryString</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">search</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span> <span class="nx">values</span><span class="p">.</span><span class="nx">access_token</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="p">){</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&#34;looks like we&#39;ve got an access_token!&#34;</span><span class="p">,</span> <span class="nx">values</span><span class="p">.</span><span class="nx">access_token</span> <span class="p">)</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span> <span class="p">{...</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">,</span> <span class="nx">access_token</span><span class="o">:</span> <span class="nx">values</span><span class="p">.</span><span class="nx">access_token</span> <span class="p">}</span> <span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&#34;No token&#34;</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">access_token</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">&lt;</span><span class="nt">Unsplash</span> <span class="na">access_token</span><span class="o">=</span><span class="s">{this.state.access_token}/</span><span class="p">&gt;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">(</span>
        <span class="p">&lt;</span><span class="nt">LoginWindow</span><span class="p">/&gt;</span>
      <span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></div>
<p>We need to create that <code>Unsplash</code> component, so lets do that now inside of <code>src/Unsplash.js</code> (and don&rsquo;t forget to <code>import</code> this at the top of <code>App.js</code>!)</p>
<div class="highlight"><pre class="chroma"><code class="language-jsx" data-lang="jsx"><span class="k">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Container</span><span class="p">,</span> <span class="nx">Progress</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;reactstrap&#39;</span>

<span class="k">const</span> <span class="nx">authedGet</span> <span class="o">=</span> <span class="p">(</span><span class="nx">access_token</span><span class="p">,</span> <span class="nx">endpoint</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">const</span> <span class="nx">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Accept&#39;</span><span class="o">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Accept-Version&#39;</span><span class="o">:</span> <span class="s1">&#39;v1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Authorization&#39;</span><span class="o">:</span> <span class="sb">`Bearer </span><span class="si">${</span><span class="nx">access_token</span><span class="si">}</span><span class="sb">`</span>
  <span class="p">}</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&#34;headers&#34;</span><span class="p">,</span> <span class="nx">headers</span><span class="p">)</span>
  <span class="k">const</span> <span class="nx">fetchInit</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;GET&#39;</span><span class="p">,</span>
    <span class="nx">headers</span><span class="p">,</span>
    <span class="nx">credentials</span><span class="o">:</span> <span class="s1">&#39;omit&#39;</span><span class="p">,</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">fetch</span><span class="p">(</span><span class="s2">&#34;https://api.unsplash.com&#34;</span> <span class="o">+</span> <span class="nx">endpoint</span><span class="p">,</span> <span class="nx">fetchInit</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">const</span> <span class="nx">Loading</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">Container</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Fetching</span> <span class="nx">from</span> <span class="nx">the</span> <span class="nx">unsplash</span> <span class="nx">api</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">Progress</span> <span class="na">animated</span> <span class="na">color</span><span class="o">=</span><span class="s">&#34;primary&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">{100}/</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">Container</span><span class="p">&gt;</span>
  <span class="p">)</span>
<span class="p">}</span>

<span class="k">const</span> <span class="nx">Profile</span> <span class="o">=</span> <span class="p">({</span><span class="nx">user</span><span class="p">})</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">Container</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Hello</span> <span class="p">{</span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">!</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">{user.profile_image.large}</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;profile photo&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;/</span><span class="nt">Container</span><span class="p">&gt;</span>
  <span class="p">)</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="k">class</span> <span class="nx">Unsplash</span> <span class="k">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">state</span> <span class="o">=</span> <span class="p">{</span><span class="nx">loading</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span>

  <span class="nx">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">const</span> <span class="p">{</span><span class="nx">access_token</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>

    <span class="nx">authedGet</span><span class="p">(</span> <span class="nx">access_token</span><span class="p">,</span> <span class="s2">&#34;/me&#34;</span> <span class="p">).</span><span class="nx">then</span><span class="p">(</span> <span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&#34;Got response &#34;</span> <span class="o">+</span> <span class="nx">response</span><span class="p">.</span><span class="nx">status_code</span><span class="p">)</span>
      <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">()</span>
    <span class="p">}).</span><span class="nx">then</span><span class="p">(</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span> <span class="p">{</span><span class="nx">loading</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="nx">data</span><span class="p">})</span>
    <span class="p">})</span>
  <span class="p">}</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">loading</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">(&lt;</span><span class="nt">Loading</span><span class="p">/&gt;)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">user</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">(&lt;</span><span class="nt">Profile</span> <span class="na">user</span><span class="o">=</span><span class="s">{this.state.user}/</span><span class="p">&gt;)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">(&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Horrible</span> <span class="nx">error</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></div>
<p>The first thing that we are doing is creating a utility function that uses the <code>fetch</code> function and passes the <code>Bearer</code> token, a/k/a <code>access_token</code> to the api.  In the <code>componentDidMount</code> method of the <code>Unsplash</code> class, we use that function to initiate the request.  Once we get that data, we show the rather bare bones <code>Profile</code> component that has a name and a picture in it.</p>

<p><img src="profile.png" alt="profile image"/></p>

<p>Proof of concept: working locally!</p>

<h2 id="deploying-everything-to-firebase">Deploying everything to firebase</h2>

<p>Now lets package this up to run on production.  First we need to tell the react app where the firebase functions are.  Go to the <a href="https://console.firebase.google.com">FireBase Console</a>, select your project, and find the functions admin panel on the left side.  See where the are deployed.  Mine is <code>https://us-central1-honey-b6642.cloudfunctions.net/oauth</code>, so in <code>.env.production</code> lets add:</p>

<pre><code>REACT_APP_BASE_URL=&quot;https://us-central1-honey-b6642.cloudfunctions.net/oauth&quot;
</code></pre>

<p>Now lets kick off a production build of the react app:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ yarn build</code></pre></div>
<p>Now we need to setup the config for the firebase functions.  Lets make sure that we have an entry for everything that is in our <code>functions/.runtimeconfig.json</code> file.  First set the static_site_url value to the url you are looking at, in my case <code>https://honey-b6642.firebaseapp.com/</code></p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ firebase functions:config:set oauth.static_site_url<span class="o">=</span>https://honey-b6642.firebaseapp.com/</code></pre></div>
<p>For the redirect_uri, use the same as the <code>REACT_APP_BASE_URL</code> above but add <code>/callback</code>.  Mine is <code>https://us-central1-honey-b6642.cloudfunctions.net/oauth</code>, so</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ firebase functions:config:set oauth.redirect_uri<span class="o">=</span>https://us-central1-honey-b6642.cloudfunctions.net/oauth/callback</code></pre></div>
<p>Once that is done, lets push both the html/css/js code as well as the functions to firebase:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ firebase deploy</code></pre></div>
<p>If you have the <a href="https://github.com/firebase/firebase-tools/issues/775">problem listed here</a>, update <code>functions/package.json</code> to downgrade <code>simple-oauth2</code> to <code>^1.6.0</code>, return <code>yarn</code> in the <code>functions</code> directory, and retry the firebase deploy.</p>

<p>Finally, we need to whitelist our callback URL inside of the <a href="https://unsplash.com/oauth/applications">Unsplash Application</a>.  Follow that link, select your application, and add that same callback url from above after the localhost one that should already be there.</p>

<p>Now lets test it out!  Make sure that you have billing enabled in FireBase, otherwise you won&rsquo;t be able to make external requests and you will get a host not found error.</p>

<h2 id="final-thoughts">Final thoughts</h2>

<p>The code is available on GitHub here:  <a href="https://github.com/wschenk/unsplash_api_firebase">https://github.com/wschenk/unsplash_api_firebase</a></p>

<p>We&rsquo;ve covered a lot of ground here!</p>

<ol>
<li>Overview of the OAuth protocol</li>
<li>Hosting a static create-react-app site on firebase</li>
<li>Building firebase functions and testing them locally</li>
<li>Environment config with create-react-app in production and development</li>
<li>Environment config with firebase functions, also in production and development</li>
<li>Using <code>simple-oauth2</code></li>
<li>A quick and easy way to pass the access_token back to our react app</li>
<li>How to use the <code>Bearer</code> token using <code>window.fetch</code> to get authenticated data from an API.</li>
</ol>

<hr />

<h3 id="references">References</h3>

<ol>
<li><a href="https://github.com/wschenk/unsplash_api_firebase">https://github.com/wschenk/unsplash_api_firebase</a></li>
<li><a href="https://firebase.google.com/docs/functions/get-started">https://firebase.google.com/docs/functions/get-started</a></li>
<li><a href="https://firebase.google.com/docs/functions/local-emulator">https://firebase.google.com/docs/functions/local-emulator</a></li>
<li><a href="https://www.netlify.com/blog/2018/07/30/how-to-setup-serverless-oauth-flows-with-netlify-functions--intercom/">https://www.netlify.com/blog/2018/07/30/how-to-setup-serverless-oauth-flows-with-netlify-functions--intercom/</a></li>
<li><a href="https://github.com/Herohtar/netlify-cms-oauth-firebase">https://github.com/Herohtar/netlify-cms-oauth-firebase</a></li>
<li><a href="https://unsplash.com/documentation">https://unsplash.com/documentation</a></li>
<li><a href="https://github.com/unsplash/unsplash-js">https://github.com/unsplash/unsplash-js</a></li>
</ol>

  </article>
</div>


  <div class="bg-light py-5">
    <div class="container">
      <h2 class="text-center">Read next</h2>

      <div class="row">
        <div class="col-md-6 text-center">
          
        </div>
        <div class="col-md-6 text-center">
          
            Previous Post:
            <a href="../../../articles/2018/adding_facebook_login_with_react/">Adding Facebook Login with react</a>
          
        </div>
      </div>
    </div>
  </div>




<div class="container mt-5">
  <h2 class="text-center">See also</h2>
  <div class="row">
  	
      <div class="col-md mb-3">
        <p class="lead mb-0"><a class="text-body" href="../../../articles/2018/automating_hugo_with_circleci/">Automating hugo builds using CircleCI</a></p>

        
          <p class="lead font-italic mb-0">Let someone else run your build server</p>
        
        <p class="font-weight-light mt-3"><p class="lead">Here's a simple CircleCI configuration to pull down the latest version of your hugo site on GitHub commits, build it, and then push it to github pages.</p></p>
        <a href="../../../articles/2018/automating_hugo_with_circleci/" class="btn btn-primary">Read more</a>
      </div>
    
      <div class="col-md mb-3">
        <p class="lead mb-0"><a class="text-body" href="../../../articles/2018/adding_a_cms_to_hugo/">Adding a CMS to hugo</a></p>

        
          <p class="lead font-italic mb-0">Static doesn&rsquo;t mean dead</p>
        
        <p class="font-weight-light mt-3">Just because we have a static site doesn&rsquo;t mean that we can&rsquo;t have an admin tool to write and edit posts! Lets go through how we can add the NetlifyCMS to the site and host it wherever we want.
In my case I&rsquo;m storing the code on GitHub and also serving the pages from GitHub Pages. Netlify also seems like a really promising company with a number of other services that they offer, so I&rsquo;d encourage you to check it out.</p>
        <a href="../../../articles/2018/adding_a_cms_to_hugo/" class="btn btn-primary">Read more</a>
      </div>
    
      <div class="col-md mb-3">
        <p class="lead mb-0"><a class="text-body" href="../../../articles/2018/building-a-hugo-site/">Building a hugo site and theme with Bootstrap</a></p>

        
          <p class="lead font-italic mb-0">hugo is blazing fast</p>
        
        <p class="font-weight-light mt-3">Now that&rsquo;s its 2018 its time to retool the blog using hugo. Why not? Hugo is built in golang and is blazing fast and everything is cleaner than it was in the middleman years.
One of the reasons that I liked middleman &ndash; it&rsquo;s usage of the rails&rsquo; Sprockets library &ndash; is no longer a strength. The javascript and front-end world has moved over to WebPack and I&rsquo;ve personally moved over to create-react-app.</p>
        <a href="../../../articles/2018/building-a-hugo-site/" class="btn btn-primary">Read more</a>
      </div>
    
  </div>
</div>


<footer class="footer bg-dark text-light mt-3">
  <div class="container">
    <h2 class="py-5 font-weight-light my-0">Made in Brooklyn, NY.</h2>
  </div>
</footer>
</body>
</html>
