<!DOCTYPE html>
<html><head>
  <title>Adding a CMS to hugo</title>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../../css/theme.css"/>
  
  <link rel="stylesheet" href="../../../css/syntax.css"/>

  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-56296045-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  <meta property="og:title" content="Adding a CMS to hugo" />
<meta property="og:description" content="Just because we have a static site doesn&rsquo;t mean that we can&rsquo;t have an admin tool to write and edit posts! Lets go through how we can add the NetlifyCMS to the site and host it wherever we want.
In my case I&rsquo;m storing the code on GitHub and also serving the pages from GitHub Pages. Netlify also seems like a really promising company with a number of other services that they offer, so I&rsquo;d encourage you to check it out." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://willschenk.com/articles/2018/adding_a_cms_to_hugo/" />
<meta property="article:published_time" content="2018-10-27T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2018-10-27T00:00:00&#43;00:00"/>

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Adding a CMS to hugo"/>
<meta name="twitter:description" content="Just because we have a static site doesn&rsquo;t mean that we can&rsquo;t have an admin tool to write and edit posts! Lets go through how we can add the NetlifyCMS to the site and host it wherever we want.
In my case I&rsquo;m storing the code on GitHub and also serving the pages from GitHub Pages. Netlify also seems like a really promising company with a number of other services that they offer, so I&rsquo;d encourage you to check it out."/>
<meta name="twitter:site" content="@wschenk"/>


  <style>
    .article p, .article ul, .article ol, .article table {
      max-width: 45em;
    }

    article.article p:first-child, .article blockquote {
      font-size: 1.25em;
      font-weight: 300;
      max-width: 36em;  
    }
  </style>
</head>
<body><nav class="container my-5">
  <h1 class="pt-5 display-3"><a class="text-dark" href="../../../">Will Schenk</a></h1>
  <p>
    
      <a class="text-dark h4 mr-3 font-weight-light" href="../../../articles/" title="">Articles</a>
    
      <a class="text-dark h4 mr-3 font-weight-light" href="../../../contact" title="">Contact</a>
    
      <a class="text-dark h4 mr-3 font-weight-light" href="../../../tags/" title="">Tags</a>
    
    <a href="../../../feed.xml" class="mr-3 h4 text-light"><img src="../../../img/rss.svg" alt="rss" height="20" width="20"/></a>
    
      <a href="https://twitter.com/@wschenk" class="mr-3 h4 text-light"><img src="../../../img/twitter.svg" alt="twitter" height="20" width="20"/></a>
    
    
      <a href="https://instagram.com/wschenk" class="mr-3 h4 text-light"><img src="../../../img/instagram.svg" alt="instagram" height="20" width="20"/></a>
    
    
      <a href="https://linkedin.com/in/will-schenk-420266" class="mr-3 h4 text-light"><img src="../../../img/linkedin.svg" alt="linkedin" height="20" width="20"/></a>
    
  </p>
</nav>

<div class="container">
  <h1 class="mt-5">Adding a CMS to hugo</h1>

  
    <h2 class="font-weight-light font-italic mb-3">Static doesn&rsquo;t mean dead</h2>
  

  <p class="text-muted mt-3">
    <a class="text-muted" href="https://willschenk.com/articles/2018/adding_a_cms_to_hugo/">Published October 27, 2018</a>

    
      <a class="text-muted" href="../../../tags/hugo">#hugo</a>
    
      <a class="text-muted" href="../../../tags/howto">#howto</a>
    
      <a class="text-muted" href="../../../tags/static_sites">#static_sites</a>
    
      <a class="text-muted" href="../../../tags/netlify">#netlify</a>
    
  </p>

  

  <article class="article mt-5">
    

<p>Just because we have a static site doesn&rsquo;t mean that we can&rsquo;t have an admin tool to write and edit posts!  Lets go through how we can <a href="https://www.netlifycms.org/docs/add-to-your-site/">add the NetlifyCMS</a> to the site and host it wherever we want.</p>

<p>In my case I&rsquo;m storing the code on <a href="https://github.com">GitHub</a> and also serving the pages from <a href="https://pages.github.com/">GitHub Pages</a>.  <a href="https://www.netlify.com/">Netlify</a> also seems like a really promising company with a number of other services that they offer, so I&rsquo;d encourage you to check it out.  But since I&rsquo;m changing one thing at a time, I&rsquo;ll leave that for a later exercise.</p>

<p>The CMS works by loading the code and it&rsquo;s configuration from your site.  These are 100% static so nothing needs to happen at build time.  The configuration tells the admin &ndash; which again runs totally in your browser &ndash; where to get authentication and the data for your site.  Once that&rsquo;s done you&rsquo;ll need to figure out how to setup the build process.</p>

<h2 id="install-the-admin">Install the admin</h2>

<p>in <code>/static/admin/index.html</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!doctype html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;utf-8&#34;</span> <span class="p">/&gt;</span>
  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span> <span class="p">/&gt;</span>
  <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Content Manager<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
  <span class="c">&lt;!-- Include the script that builds the page and powers Netlify CMS --&gt;</span>
  <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://unpkg.com/netlify-cms@^2.0.0/dist/netlify-cms.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></code></pre></div>
<p>Then in `<code>/static/admin/config.yml</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-yml" data-lang="yml">backend<span class="p">:</span><span class="w">
</span><span class="w">  </span>name<span class="p">:</span><span class="w"> </span>github<span class="w">
</span><span class="w">  </span>repo<span class="p">:</span><span class="w"> </span>wschenk/willschenk.com<span class="w">
</span><span class="w">
</span><span class="w"></span>publish_mode<span class="p">:</span><span class="w"> </span>editorial_workflow<span class="w">
</span><span class="w">
</span><span class="w"></span>media_folder<span class="p">:</span><span class="w"> </span>static/img/uploads<span class="w">
</span><span class="w"></span>public_folder<span class="p">:</span><span class="w"> </span>img/uploads<span class="w">
</span><span class="w">
</span><span class="w"></span>collections<span class="p">:</span><span class="w">
</span><span class="w">  </span>-<span class="w"> </span>name<span class="p">:</span><span class="w"> </span><span class="s2">&#34;articles&#34;</span><span class="w">
</span><span class="w">    </span>label<span class="p">:</span><span class="w"> </span><span class="s2">&#34;Articles&#34;</span><span class="w">
</span><span class="w">    </span>folder<span class="p">:</span><span class="w"> </span><span class="s2">&#34;content/articles&#34;</span><span class="w">
</span><span class="w">    </span>create<span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="w">    </span>fields<span class="p">:</span><span class="w">
</span><span class="w">      </span>-<span class="w"> </span>{<span class="w"> </span>label<span class="p">:</span><span class="w"> </span><span class="s2">&#34;Title&#34;</span><span class="p">,</span><span class="w"> </span>name<span class="p">:</span><span class="w"> </span><span class="s2">&#34;title&#34;</span><span class="p">,</span><span class="w"> </span>widget<span class="p">:</span><span class="w"> </span><span class="s2">&#34;string&#34;</span><span class="w"> </span>}<span class="w">
</span><span class="w">      </span>-<span class="w"> </span>{<span class="w"> </span>label<span class="p">:</span><span class="w"> </span><span class="s2">&#34;Date&#34;</span><span class="p">,</span><span class="w"> </span>name<span class="p">:</span><span class="w"> </span><span class="s2">&#34;date&#34;</span><span class="p">,</span><span class="w"> </span>widget<span class="p">:</span><span class="w"> </span><span class="s2">&#34;date&#34;</span><span class="w"> </span>}<span class="w">
</span><span class="w">      </span>-<span class="w"> </span>{<span class="w"> </span>label<span class="p">:</span><span class="w"> </span><span class="s2">&#34;Body&#34;</span><span class="p">,</span><span class="w"> </span>name<span class="p">:</span><span class="w"> </span><span class="s2">&#34;body&#34;</span><span class="p">,</span><span class="w"> </span>widget<span class="p">:</span><span class="w"> </span><span class="s2">&#34;markdown&#34;</span><span class="w"> </span>}</code></pre></div>
<h2 id="what-if-i-don-t-have-a-netlify-account">What if I don&rsquo;t have a netlify account?</h2>

<p>There are a number of ways to do this, but we are going to</p>

<ol>
<li><a href="https://developer.github.com/apps/building-oauth-apps/creating-an-oauth-app/">Create a GitHub application</a> that will do the granting</li>
<li>Create a firebase application to handle the accounts</li>
<li>Wire everything together.</li>
</ol>

<h3 id="creating-the-github-app">Creating the GitHub app</h3>

<p>Go to <a href="https://github.com/settings/developers">GitHub developer settings</a>.  You can access this by clicking on your profile, selecting <code>Settings</code>, and then selecting <code>Developer Settings</code>.</p>

<p>Create a <code>New OAuth App</code>.</p>

<p>Leave the callback URL blank for now &ndash; we&rsquo;ll set that up with a url that we will get from firebase shortly.</p>

<p><em>Take note of the client ID and client secret, we&rsquo;ll need those shortly</em></p>

<h3 id="creating-the-firebase-application">Creating the firebase application</h3>

<p>We will spin up something on firebase to help handle the oauth dance.</p>

<p>First lets checkout some code that will handle the api interactions.  We are going to install this code on firebase.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ git clone https://github.com/Herohtar/netlify-cms-oauth-firebase
$ <span class="nb">cd</span> netlify-cms-oauth-firebase/functions/
$ npm i
$ <span class="nb">cd</span> ..</code></pre></div>
<p>Then install  <code>firebase-tools</code> if you haven&rsquo;t already</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ npm add -g firebase-tools</code></pre></div>
<p>Next log in to firebase</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ firebase login</code></pre></div>
<p>Go to the <a href="https://console.firebase.google.com/">firebase console</a> and create an application.  Then configure firebase to use that project</p>

<pre><code>$ firebase use projectname
</code></pre>

<p>Now lets setup the client id and secret that we got from GitHub:</p>

<pre><code>$ firebase functions:config:set oauth.client_id=yourclientid oauth.client_secret=yourclientsecret
</code></pre>

<p>This will take a few seconds to finish.  Now we can deploy our functions, and get the URL that GitHub will use to pass back the authentication.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ firebase deploy --only functions</code></pre></div>
<p>Note the url of the application deployed, in my case it is <code>https://us-central1-willschenkcom.cloudfunctions.net/oauth</code></p>

<h3 id="wiring-it-all-up">Wiring it all up</h3>

<p>Go back to the GitHub app page and change your app&rsquo;s callback to the hostname/oauth/callback &ndash; in my case <code>https://us-central1-willschenkcom.cloudfunctions.net/oauth/callback</code>.</p>

<p>Then in <code>static/admin/config.yml</code> set the <code>baseURL</code> to your firebase application.  In my case the relavent section looks like:</p>
<div class="highlight"><pre class="chroma"><code class="language-yml" data-lang="yml">backend<span class="p">:</span><span class="w">
</span><span class="w">  </span>name<span class="p">:</span><span class="w"> </span>github<span class="w">
</span><span class="w">  </span>repo<span class="p">:</span><span class="w"> </span>wschenk/willschenk.com<span class="w">
</span><span class="w">  </span>base_url<span class="p">:</span><span class="w"> </span>https<span class="p">:</span>//us-central1-willschenkcom.cloudfunctions.net<span class="w">
</span><span class="w">  </span>auth_endpoint<span class="p">:</span><span class="w"> </span>/oauth/auth</code></pre></div>
<h2 id="summary">Summary</h2>

<p>The NetlifyCMS is really interesting, though its still a work in progress.  With this setup, we are using a couple of external services &ndash; GitHub, Firebase &ndash; all within their free tiers to edit and push out a website. This process would probably be even easier if we went all in with Netlify, so that&rsquo;s another great service to start checking out.</p>

<p>Originally I had <a href="automating_hugo_with_circle_ci">configuring CircleCI</a> in this post, but I moved it to its own!  Read next!</p>

  </article>
</div>


  <div class="bg-light py-5">
    <div class="container">
      <h2 class="text-center">Read next</h2>

      <div class="row">
        <div class="col-md-6 text-center">
          
            Next Post:
            <a href="../../../articles/2018/automating_hugo_with_circleci/">Automating hugo builds using CircleCI</a>
          
        </div>
        <div class="col-md-6 text-center">
          
            Previous Post:
            <a href="../../../articles/2018/building-a-hugo-site/">Building a hugo site and theme with Bootstrap</a>
          
        </div>
      </div>
    </div>
  </div>




<div class="container mt-5">
  <h2 class="text-center">See also</h2>
  <div class="row">
  	
      <div class="col-md mb-3">
        <p class="lead mb-0"><a class="text-body" href="../../../articles/2018/building-a-hugo-site/">Building a hugo site and theme with Bootstrap</a></p>

        
          <p class="lead font-italic mb-0">hugo is blazing fast</p>
        
        <p class="font-weight-light mt-3">Now that&rsquo;s its 2018 its time to retool the blog using hugo. Why not? Hugo is built in golang and is blazing fast and everything is cleaner than it was in the middleman years.
One of the reasons that I liked middleman &ndash; it&rsquo;s usage of the rails&rsquo; Sprockets library &ndash; is no longer a strength. The javascript and front-end world has moved over to WebPack and I&rsquo;ve personally moved over to create-react-app.</p>
        <a href="../../../articles/2018/building-a-hugo-site/" class="btn btn-primary">Read more</a>
      </div>
    
      <div class="col-md mb-3">
        <p class="lead mb-0"><a class="text-body" href="../../../articles/2015/slow-data-and-fast-sites/">Slow data and Fast Sites</a></p>

        
          <p class="lead font-italic mb-0">building fast, searchable, functional sites that fail gracefully</p>
        
        <p class="font-weight-light mt-3">This article walks through the motivations driving and benefits of using a the Seed Architecture for building performant websites using Middleman, React, and a seperate API server such as Parse. The benefits are:
 You get full SEO with a heavy client JavaScript site without having to do crazy things with PhantomJS or meta fragments. Hosting and operations become both cheap and doesn&rsquo;t require a support team. Scaling out the system is mainly a bandwidth problem, and secondarily a API scaling problem for a subset of behavior.</p>
        <a href="../../../articles/2015/slow-data-and-fast-sites/" class="btn btn-primary">Read more</a>
      </div>
    
      <div class="col-md mb-3">
        <p class="lead mb-0"><a class="text-body" href="../../../articles/2017/getting_firebase_and_grpc_working_under_termux/">Getting firebase and grpc working under termux</a></p>

        
        <p class="font-weight-light mt-3">firebase depends on grpc, which isn’t set to build right on the Chromebook. This is because node-pre-gyp, which is used to download precompiled binaries, is not setup correctly. In then uses node-gyp to compile the C++ bindings directly, which is also not setup correctly.
We are going to adjust the settings of node-gyp to make it compile things right under termux, and then we are going to tweak the grpc package itself in our local cache to make it build correctly.</p>
        <a href="../../../articles/2017/getting_firebase_and_grpc_working_under_termux/" class="btn btn-primary">Read more</a>
      </div>
    
  </div>
</div>


<footer class="footer bg-dark text-light mt-3">
  <div class="container">
    <h2 class="py-5 font-weight-light my-0">Made in Brooklyn, NY.</h2>
  </div>
</footer>
</body>
</html>
